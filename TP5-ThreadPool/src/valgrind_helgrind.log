==51159== Helgrind, a thread error detector
==51159== Copyright (C) 2007-2017, and GNU GPL'd, by OpenWorks LLP et al.
==51159== Using Valgrind-3.22.0 and LibVEX; rerun with -h for copyright info
==51159== Command: ./threadpool --all
==51159== 
[36m[B01][0m Basic execution (3 tasks on 2 threads)... ==51160== ---Thread-Announcement------------------------------------------
==51160== 
==51160== Thread #1 is the program's root thread
==51160== 
==51160== ---Thread-Announcement------------------------------------------
==51160== 
==51160== Thread #2 was created
==51160==    at 0x4C3EA23: clone (clone.S:76)
==51160==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51160==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51160==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51160==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51160==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51160==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51160==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51160==    by 0x113CDF: test_basic() (test_custom.cc:62)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160== 
==51160== ----------------------------------------------------------------
==51160== 
==51160==  Lock at 0x1FFEFFEA38 was first observed
==51160==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51160==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51160==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51160==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51160==    by 0x113D83: test_basic() (test_custom.cc:65)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51160==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51160==    by 0x11A0DF: main (test_custom.cc:951)
==51160==  Address 0x1ffeffea38 is on thread #1's stack
==51160==  in frame #3, created by test_basic() (test_custom.cc:60)
==51160== 
==51160==  Lock at 0x1FFEFFEAE0 was first observed
==51160==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51160==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51160==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51160==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51160==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51160==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51160==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51160==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51160==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51160==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51160==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51160==  Address 0x1ffeffeae0 is on thread #1's stack
==51160==  in frame #3, created by test_basic() (test_custom.cc:60)
==51160== 
==51160== Possible data race during write of size 8 at 0x1FFEFFEA90 by thread #1
==51160== Locks held: 1, at address 0x1FFEFFEA38
==51160==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51160==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51160==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51160==    by 0x113D83: test_basic() (test_custom.cc:65)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51160==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51160==    by 0x11A0DF: main (test_custom.cc:951)
==51160== 
==51160== This conflicts with a previous read of size 8 by thread #2
==51160== Locks held: 1, at address 0x1FFEFFEAE0
==51160==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51160==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51160==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51160==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51160==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51160==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51160==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51160==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51160==  Address 0x1ffeffea90 is on thread #1's stack
==51160==  in frame #3, created by test_basic() (test_custom.cc:60)
==51160== 
==51160== ----------------------------------------------------------------
==51160== 
==51160== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51160==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51160==    by 0x113D83: test_basic() (test_custom.cc:65)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51160==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51160==    by 0x11A0DF: main (test_custom.cc:951)
==51160== 
==51160== ----------------------------------------------------------------
==51160== 
==51160==  Lock at 0x1FFEFFEA38 was first observed
==51160==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51160==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51160==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51160==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51160==    by 0x113D83: test_basic() (test_custom.cc:65)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51160==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51160==    by 0x11A0DF: main (test_custom.cc:951)
==51160==  Address 0x1ffeffea38 is on thread #1's stack
==51160==  in frame #5, created by test_basic() (test_custom.cc:60)
==51160== 
==51160==  Lock at 0x1FFEFFEAE0 was first observed
==51160==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51160==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51160==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51160==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51160==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51160==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51160==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51160==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51160==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51160==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51160==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51160==  Address 0x1ffeffeae0 is on thread #1's stack
==51160==  in frame #5, created by test_basic() (test_custom.cc:60)
==51160== 
==51160==  Lock at 0x1FFEFFEB38 was first observed
==51160==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51160==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51160==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51160==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51160==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51160==    by 0x113DB1: test_basic() (test_custom.cc:69)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51160==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51160==  Address 0x1ffeffeb38 is on thread #1's stack
==51160==  in frame #5, created by test_basic() (test_custom.cc:60)
==51160== 
==51160== Possible data race during write of size 8 at 0x1FFEFFEA70 by thread #2
==51160== Locks held: 2, at addresses 0x1FFEFFEA38 0x1FFEFFEAE0
==51160==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51160==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51160==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51160==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51160==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51160==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51160==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51160==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51160==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51160==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51160==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51160== 
==51160== This conflicts with a previous read of size 8 by thread #1
==51160== Locks held: 1, at address 0x1FFEFFEB38
==51160==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51160==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51160==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51160==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51160==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51160==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51160==    by 0x113DB1: test_basic() (test_custom.cc:69)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==  Address 0x1ffeffea70 is on thread #1's stack
==51160==  in frame #5, created by test_basic() (test_custom.cc:60)
==51160== 
==51160== ---Thread-Announcement------------------------------------------
==51160== 
==51160== Thread #3 was created
==51160==    at 0x4C3EA23: clone (clone.S:76)
==51160==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51160==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51160==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51160==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51160==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51160==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51160==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51160==    by 0x113CDF: test_basic() (test_custom.cc:62)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160== 
==51160== ----------------------------------------------------------------
==51160== 
==51160== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51160==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51160==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51160==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51160==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51160==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51160==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51160==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51160==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51160==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51160==    by 0x4C3EA33: clone (clone.S:100)
==51160== 
==51160== ---Thread-Announcement------------------------------------------
==51160== 
==51160== Thread #4 was created
==51160==    at 0x4C3EA23: clone (clone.S:76)
==51160==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51160==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51160==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51160==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51160==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51160==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51160==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51160==    by 0x113CDF: test_basic() (test_custom.cc:62)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160== 
==51160== ----------------------------------------------------------------
==51160== 
==51160== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51160==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51160==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51160==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51160==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51160==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51160==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51160==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51160==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51160==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51160==    by 0x4C3EA33: clone (clone.S:100)
==51160== 
==51160== ----------------------------------------------------------------
==51160== 
==51160== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51160==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51160==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51160==    by 0x113E73: test_basic() (test_custom.cc:75)
==51160==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51160==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51160==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51160==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51160==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51160==    by 0x11A0DF: main (test_custom.cc:951)
==51160== 
==51160== 
==51160== Use --history-level=approx or =none to gain increased speed, at
==51160== the cost of reduced accuracy of conflicting-access information
==51160== For lists of detected and suppressed errors, rerun with: -s
==51160== ERROR SUMMARY: 11 errors from 6 contexts (suppressed: 213 from 27)
[1;31m❌ FAILED[0m
[36m[B02][0m Wait without scheduling... ==51164== ---Thread-Announcement------------------------------------------
==51164== 
==51164== Thread #1 is the program's root thread
==51164== 
==51164== ----------------------------------------------------------------
==51164== 
==51164== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51164==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51164==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51164==    by 0x113F9D: test_wait_only() (test_custom.cc:85)
==51164==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51164==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51164==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51164==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51164==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51164==    by 0x11A0DF: main (test_custom.cc:951)
==51164== 
==51164== 
==51164== Use --history-level=approx or =none to gain increased speed, at
==51164== the cost of reduced accuracy of conflicting-access information
==51164== For lists of detected and suppressed errors, rerun with: -s
==51164== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 97 from 16)
[1;31m❌ FAILED[0m
[36m[B03][0m Serial execution with 1 thread... ==51170== ---Thread-Announcement------------------------------------------
==51170== 
==51170== Thread #1 is the program's root thread
==51170== 
==51170== ---Thread-Announcement------------------------------------------
==51170== 
==51170== Thread #2 was created
==51170==    at 0x4C3EA23: clone (clone.S:76)
==51170==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51170==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51170==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51170==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51170==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51170==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51170==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51170==    by 0x11410A: test_serial_execution() (test_custom.cc:94)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170== 
==51170== ----------------------------------------------------------------
==51170== 
==51170==  Lock at 0x1FFEFFE8B8 was first observed
==51170==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51170==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51170==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51170==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51170==    by 0x114170: test_serial_execution() (test_custom.cc:96)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51170==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51170==    by 0x11A0DF: main (test_custom.cc:951)
==51170==  Address 0x1ffeffe8b8 is on thread #1's stack
==51170==  in frame #3, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170==  Lock at 0x1FFEFFE960 was first observed
==51170==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51170==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51170==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51170==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51170==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51170==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51170==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51170==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51170==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51170==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51170==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51170==  Address 0x1ffeffe960 is on thread #1's stack
==51170==  in frame #3, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170== Possible data race during write of size 8 at 0x1FFEFFE910 by thread #1
==51170== Locks held: 1, at address 0x1FFEFFE8B8
==51170==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51170==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51170==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51170==    by 0x114170: test_serial_execution() (test_custom.cc:96)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51170==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51170==    by 0x11A0DF: main (test_custom.cc:951)
==51170== 
==51170== This conflicts with a previous read of size 8 by thread #2
==51170== Locks held: 1, at address 0x1FFEFFE960
==51170==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51170==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51170==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51170==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51170==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51170==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51170==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51170==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51170==  Address 0x1ffeffe910 is on thread #1's stack
==51170==  in frame #3, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170== ----------------------------------------------------------------
==51170== 
==51170== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51170==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51170==    by 0x114170: test_serial_execution() (test_custom.cc:96)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51170==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51170==    by 0x11A0DF: main (test_custom.cc:951)
==51170== 
==51170== ----------------------------------------------------------------
==51170== 
==51170==  Lock at 0x1FFEFFE8B8 was first observed
==51170==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51170==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51170==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51170==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51170==    by 0x114170: test_serial_execution() (test_custom.cc:96)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51170==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51170==    by 0x11A0DF: main (test_custom.cc:951)
==51170==  Address 0x1ffeffe8b8 is on thread #1's stack
==51170==  in frame #5, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170==  Lock at 0x1FFEFFE960 was first observed
==51170==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51170==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51170==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51170==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51170==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51170==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51170==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51170==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51170==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51170==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51170==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51170==  Address 0x1ffeffe960 is on thread #1's stack
==51170==  in frame #5, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170==  Lock at 0x1FFEFFE9B8 was first observed
==51170==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51170==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51170==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51170==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51170==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51170==    by 0x11419E: test_serial_execution() (test_custom.cc:101)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51170==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51170==  Address 0x1ffeffe9b8 is on thread #1's stack
==51170==  in frame #5, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170== Possible data race during write of size 8 at 0x1FFEFFE8F0 by thread #2
==51170== Locks held: 2, at addresses 0x1FFEFFE8B8 0x1FFEFFE960
==51170==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51170==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51170==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51170==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51170==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51170==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51170==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51170==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51170==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51170==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51170==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51170== 
==51170== This conflicts with a previous read of size 8 by thread #1
==51170== Locks held: 1, at address 0x1FFEFFE9B8
==51170==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51170==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51170==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51170==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51170==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51170==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51170==    by 0x11419E: test_serial_execution() (test_custom.cc:101)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==  Address 0x1ffeffe8f0 is on thread #1's stack
==51170==  in frame #5, created by test_serial_execution() (test_custom.cc:90)
==51170== 
==51170== ---Thread-Announcement------------------------------------------
==51170== 
==51170== Thread #3 was created
==51170==    at 0x4C3EA23: clone (clone.S:76)
==51170==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51170==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51170==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51170==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51170==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51170==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51170==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51170==    by 0x11410A: test_serial_execution() (test_custom.cc:94)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170== 
==51170== ----------------------------------------------------------------
==51170== 
==51170== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51170==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51170==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51170==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51170==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51170==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51170==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51170==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51170==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51170==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51170==    by 0x4C3EA33: clone (clone.S:100)
==51170== 
==51170== ----------------------------------------------------------------
==51170== 
==51170== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51170==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51170==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51170==    by 0x1141F1: test_serial_execution() (test_custom.cc:103)
==51170==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51170==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51170==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51170==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51170==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51170==    by 0x11A0DF: main (test_custom.cc:951)
==51170== 
==51170== 
==51170== Use --history-level=approx or =none to gain increased speed, at
==51170== the cost of reduced accuracy of conflicting-access information
==51170== For lists of detected and suppressed errors, rerun with: -s
==51170== ERROR SUMMARY: 18 errors from 5 contexts (suppressed: 295 from 25)
[1;31m❌ FAILED[0m
[36m[B04][0m FIFO execution in single-thread mode... ==51173== ---Thread-Announcement------------------------------------------
==51173== 
==51173== Thread #1 is the program's root thread
==51173== 
==51173== ---Thread-Announcement------------------------------------------
==51173== 
==51173== Thread #2 was created
==51173==    at 0x4C3EA23: clone (clone.S:76)
==51173==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51173==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51173==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51173==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51173==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51173==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51173==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51173==    by 0x114359: test_fifo_single_thread() (test_custom.cc:110)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173== 
==51173== ----------------------------------------------------------------
==51173== 
==51173==  Lock at 0x1FFEFFEA48 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51173==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51173==    by 0x1143E8: test_fifo_single_thread() (test_custom.cc:115)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==    by 0x11A0DF: main (test_custom.cc:951)
==51173==  Address 0x1ffeffea48 is on thread #1's stack
==51173==  in frame #3, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173==  Lock at 0x1FFEFFEAF0 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51173==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51173==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51173==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51173==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51173==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51173==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51173==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51173==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51173==  Address 0x1ffeffeaf0 is on thread #1's stack
==51173==  in frame #3, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51173== Locks held: 1, at address 0x1FFEFFEA48
==51173==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51173==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51173==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51173==    by 0x1143E8: test_fifo_single_thread() (test_custom.cc:115)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==    by 0x11A0DF: main (test_custom.cc:951)
==51173== 
==51173== This conflicts with a previous read of size 8 by thread #2
==51173== Locks held: 1, at address 0x1FFEFFEAF0
==51173==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51173==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51173==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51173==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51173==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51173==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51173==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51173==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51173==  Address 0x1ffeffeaa0 is on thread #1's stack
==51173==  in frame #3, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173== ----------------------------------------------------------------
==51173== 
==51173== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51173==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51173==    by 0x1143E8: test_fifo_single_thread() (test_custom.cc:115)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==    by 0x11A0DF: main (test_custom.cc:951)
==51173== 
==51173== ----------------------------------------------------------------
==51173== 
==51173==  Lock at 0x1FFEFFEA48 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51173==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51173==    by 0x1143E8: test_fifo_single_thread() (test_custom.cc:115)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==    by 0x11A0DF: main (test_custom.cc:951)
==51173==  Address 0x1ffeffea48 is on thread #1's stack
==51173==  in frame #5, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173==  Lock at 0x1FFEFFEAF0 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51173==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51173==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51173==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51173==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51173==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51173==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51173==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51173==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51173==  Address 0x1ffeffeaf0 is on thread #1's stack
==51173==  in frame #5, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173==  Lock at 0x1FFEFFEB48 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51173==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51173==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51173==    by 0x114416: test_fifo_single_thread() (test_custom.cc:121)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==  Address 0x1ffeffeb48 is on thread #1's stack
==51173==  in frame #5, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51173== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51173==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51173==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51173==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51173==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51173==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51173==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51173==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51173==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51173==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51173==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51173==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51173== 
==51173== This conflicts with a previous read of size 8 by thread #1
==51173== Locks held: 1, at address 0x1FFEFFEB48
==51173==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51173==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51173==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51173==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51173==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51173==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51173==    by 0x114416: test_fifo_single_thread() (test_custom.cc:121)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==  Address 0x1ffeffea80 is on thread #1's stack
==51173==  in frame #5, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173== ---Thread-Announcement------------------------------------------
==51173== 
==51173== Thread #3 was created
==51173==    at 0x4C3EA23: clone (clone.S:76)
==51173==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51173==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51173==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51173==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51173==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51173==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51173==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51173==    by 0x114359: test_fifo_single_thread() (test_custom.cc:110)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173== 
==51173== ----------------------------------------------------------------
==51173== 
==51173== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51173==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51173==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51173==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51173==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51173==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51173==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51173==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51173==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51173==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51173==    by 0x4C3EA33: clone (clone.S:100)
==51173== 
==51173== ----------------------------------------------------------------
==51173== 
==51173==  Lock at 0x1FFEFFEB48 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51173==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51173==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51173==    by 0x114416: test_fifo_single_thread() (test_custom.cc:121)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==  Address 0x1ffeffeb48 is on thread #1's stack
==51173==  in frame #6, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173==  Lock at 0x1FFEFFEA48 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51173==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51173==    by 0x1143E8: test_fifo_single_thread() (test_custom.cc:115)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==    by 0x11A0DF: main (test_custom.cc:951)
==51173==  Address 0x1ffeffea48 is on thread #1's stack
==51173==  in frame #6, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173==  Lock at 0x1FFEFFEAF0 was first observed
==51173==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51173==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51173==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51173==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51173==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51173==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51173==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51173==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51173==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51173==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51173==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51173==  Address 0x1ffeffeaf0 is on thread #1's stack
==51173==  in frame #6, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51173== Locks held: 1, at address 0x1FFEFFEB48
==51173==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51173==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51173==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51173==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51173==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51173==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51173==    by 0x114416: test_fifo_single_thread() (test_custom.cc:121)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173== 
==51173== This conflicts with a previous write of size 8 by thread #2
==51173== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51173==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51173==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51173==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51173==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51173==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51173==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51173==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51173==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51173==  Address 0x1ffeffea80 is on thread #1's stack
==51173==  in frame #6, created by test_fifo_single_thread() (test_custom.cc:108)
==51173== 
==51173== ----------------------------------------------------------------
==51173== 
==51173== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51173==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51173==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51173==    by 0x114486: test_fifo_single_thread() (test_custom.cc:127)
==51173==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51173==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51173==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51173==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51173==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51173==    by 0x11A0DF: main (test_custom.cc:951)
==51173== 
==51173== 
==51173== Use --history-level=approx or =none to gain increased speed, at
==51173== the cost of reduced accuracy of conflicting-access information
==51173== For lists of detected and suppressed errors, rerun with: -s
==51173== ERROR SUMMARY: 40 errors from 6 contexts (suppressed: 564 from 25)
[1;31m❌ FAILED[0m
[32m[C01][0m Stress with 1000 tasks... ==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #1 is the program's root thread
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #2 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51176==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176==  Lock at 0x1FFEFFEA48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51176==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176==  Address 0x1ffeffea48 is on thread #1's stack
==51176==  in frame #3, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEAF0 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==  Address 0x1ffeffeaf0 is on thread #1's stack
==51176==  in frame #3, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51176== Locks held: 1, at address 0x1FFEFFEA48
==51176==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51176==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51176==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176== 
==51176== This conflicts with a previous read of size 8 by thread #2
==51176== Locks held: 1, at address 0x1FFEFFEAF0
==51176==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51176==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51176==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51176==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51176==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51176==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==  Address 0x1ffeffeaa0 is on thread #1's stack
==51176==  in frame #3, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176==  Lock at 0x1FFEFFEA48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51176==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176==  Address 0x1ffeffea48 is on thread #1's stack
==51176==  in frame #4, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEAF0 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==  Address 0x1ffeffeaf0 is on thread #1's stack
==51176==  in frame #4, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51176== Locks held: 1, at address 0x1FFEFFEA48
==51176==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51176==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51176==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51176==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176== 
==51176== This conflicts with a previous read of size 8 by thread #2
==51176== Locks held: 1, at address 0x1FFEFFEAF0
==51176==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51176==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51176==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51176==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51176==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51176==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==  Address 0x1ffeffeaa0 is on thread #1's stack
==51176==  in frame #4, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176==  Lock at 0x1FFEFFEA48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51176==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176==  Address 0x1ffeffea48 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEAF0 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==  Address 0x1ffeffeaf0 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEB48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51176==    by 0x114642: test_concurrent_stress() (test_custom.cc:146)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==  Address 0x1ffeffeb48 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51176== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51176==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51176==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51176==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176== 
==51176== This conflicts with a previous read of size 8 by thread #1
==51176== Locks held: 1, at address 0x1FFEFFEB48
==51176==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51176==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51176==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51176==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51176==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51176==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51176==    by 0x114642: test_concurrent_stress() (test_custom.cc:146)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==  Address 0x1ffeffea80 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #3 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #5 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #4 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #6 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #7 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #7: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176==  Lock at 0x1FFEFFEA48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51176==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176==  Address 0x1ffeffea48 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEAF0 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==  Address 0x1ffeffeaf0 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEB48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51176==    by 0x114642: test_concurrent_stress() (test_custom.cc:146)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==  Address 0x1ffeffeb48 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51176== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51176==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51176==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51176==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51176==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176== 
==51176== This conflicts with a previous read of size 8 by thread #1
==51176== Locks held: 1, at address 0x1FFEFFEB48
==51176==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51176==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51176==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51176==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51176==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51176==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51176==    by 0x114642: test_concurrent_stress() (test_custom.cc:146)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==  Address 0x1ffeffea80 is on thread #1's stack
==51176==  in frame #5, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #8 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #8: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #9 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #9: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ---Thread-Announcement------------------------------------------
==51176== 
==51176== Thread #10 was created
==51176==    at 0x4C3EA23: clone (clone.S:76)
==51176==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51176==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51176==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51176==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51176==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51176==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51176==    by 0x1145B9: test_concurrent_stress() (test_custom.cc:140)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #10: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51176==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51176==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51176==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51176==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51176==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51176==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51176==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51176==    by 0x4C3EA33: clone (clone.S:100)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176==  Lock at 0x1FFEFFEB48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51176==    by 0x114642: test_concurrent_stress() (test_custom.cc:146)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==  Address 0x1ffeffeb48 is on thread #1's stack
==51176==  in frame #6, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEA48 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51176==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51176==    by 0x114611: test_concurrent_stress() (test_custom.cc:142)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176==  Address 0x1ffeffea48 is on thread #1's stack
==51176==  in frame #6, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176==  Lock at 0x1FFEFFEAF0 was first observed
==51176==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51176==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51176==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51176==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51176==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51176==  Address 0x1ffeffeaf0 is on thread #1's stack
==51176==  in frame #6, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51176== Locks held: 1, at address 0x1FFEFFEB48
==51176==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51176==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51176==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51176==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51176==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51176==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51176==    by 0x114642: test_concurrent_stress() (test_custom.cc:146)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176== 
==51176== This conflicts with a previous write of size 8 by thread #2
==51176== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51176==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51176==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51176==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51176==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51176==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51176==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51176==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51176==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51176==  Address 0x1ffeffea80 is on thread #1's stack
==51176==  in frame #6, created by test_concurrent_stress() (test_custom.cc:136)
==51176== 
==51176== ----------------------------------------------------------------
==51176== 
==51176== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51176==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51176==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51176==    by 0x1146E5: test_concurrent_stress() (test_custom.cc:150)
==51176==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51176==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51176==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51176==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51176==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51176==    by 0x11A0DF: main (test_custom.cc:951)
==51176== 
==51176== 
==51176== Use --history-level=approx or =none to gain increased speed, at
==51176== the cost of reduced accuracy of conflicting-access information
==51176== For lists of detected and suppressed errors, rerun with: -s
==51176== ERROR SUMMARY: 3391 errors from 15 contexts (suppressed: 56455 from 32)
[1;31m❌ FAILED[0m
[32m[C02][0m Reusing the pool after wait... ==51207== ---Thread-Announcement------------------------------------------
==51207== 
==51207== Thread #1 is the program's root thread
==51207== 
==51207== ---Thread-Announcement------------------------------------------
==51207== 
==51207== Thread #2 was created
==51207==    at 0x4C3EA23: clone (clone.S:76)
==51207==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51207==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51207==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51207==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51207==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51207==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51207==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51207==    by 0x1147F1: test_reuse_pool() (test_custom.cc:157)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207==  Lock at 0x1FFEFFEA48 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51207==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51207==    by 0x114838: test_reuse_pool() (test_custom.cc:159)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207==  Address 0x1ffeffea48 is on thread #1's stack
==51207==  in frame #3, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207==  Lock at 0x1FFEFFEAF0 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51207==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51207==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51207==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51207==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51207==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51207==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51207==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51207==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51207==  Address 0x1ffeffeaf0 is on thread #1's stack
==51207==  in frame #3, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51207== Locks held: 1, at address 0x1FFEFFEA48
==51207==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51207==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51207==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51207==    by 0x114838: test_reuse_pool() (test_custom.cc:159)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207== 
==51207== This conflicts with a previous read of size 8 by thread #2
==51207== Locks held: 1, at address 0x1FFEFFEAF0
==51207==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51207==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51207==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51207==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51207==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51207==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51207==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51207==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51207==  Address 0x1ffeffeaa0 is on thread #1's stack
==51207==  in frame #3, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51207==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51207==    by 0x114838: test_reuse_pool() (test_custom.cc:159)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207==  Lock at 0x1FFEFFEA48 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51207==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51207==    by 0x114838: test_reuse_pool() (test_custom.cc:159)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207==  Address 0x1ffeffea48 is on thread #1's stack
==51207==  in frame #5, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207==  Lock at 0x1FFEFFEAF0 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51207==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51207==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51207==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51207==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51207==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51207==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51207==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51207==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51207==  Address 0x1ffeffeaf0 is on thread #1's stack
==51207==  in frame #5, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207==  Lock at 0x1FFEFFEB48 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51207==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51207==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51207==    by 0x114856: test_reuse_pool() (test_custom.cc:162)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==  Address 0x1ffeffeb48 is on thread #1's stack
==51207==  in frame #5, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51207== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51207==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51207==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51207==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51207==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51207==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51207==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51207==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51207==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51207==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51207==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51207==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51207== 
==51207== This conflicts with a previous read of size 8 by thread #1
==51207== Locks held: 1, at address 0x1FFEFFEB48
==51207==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51207==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51207==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51207==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51207==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51207==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51207==    by 0x114856: test_reuse_pool() (test_custom.cc:162)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==  Address 0x1ffeffea80 is on thread #1's stack
==51207==  in frame #5, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207== ---Thread-Announcement------------------------------------------
==51207== 
==51207== Thread #3 was created
==51207==    at 0x4C3EA23: clone (clone.S:76)
==51207==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51207==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51207==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51207==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51207==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51207==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51207==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51207==    by 0x1147F1: test_reuse_pool() (test_custom.cc:157)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51207==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51207==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51207==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51207==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51207==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51207==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51207==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51207==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51207==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51207==    by 0x4C3EA33: clone (clone.S:100)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207==  Lock at 0x1FFEFFEA48 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51207==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51207==    by 0x114838: test_reuse_pool() (test_custom.cc:159)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207==  Address 0x1ffeffea48 is on thread #1's stack
==51207==  in frame #3, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207==  Lock at 0x1FFEFFEAF0 was first observed
==51207==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51207==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51207==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51207==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51207==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51207==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51207==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51207==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51207==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51207==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51207==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51207==  Address 0x1ffeffeaf0 is on thread #1's stack
==51207==  in frame #3, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51207== Locks held: 1, at address 0x1FFEFFEA48
==51207==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51207==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51207==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51207==    by 0x1148B2: test_reuse_pool() (test_custom.cc:165)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207== 
==51207== This conflicts with a previous read of size 8 by thread #2
==51207== Locks held: 1, at address 0x1FFEFFEAF0
==51207==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51207==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51207==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51207==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51207==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51207==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51207==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51207==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51207==  Address 0x1ffeffeaa0 is on thread #1's stack
==51207==  in frame #3, created by test_reuse_pool() (test_custom.cc:155)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51207==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51207==    by 0x1148B2: test_reuse_pool() (test_custom.cc:165)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207== 
==51207== ----------------------------------------------------------------
==51207== 
==51207== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51207==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51207==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51207==    by 0x1148E6: test_reuse_pool() (test_custom.cc:170)
==51207==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51207==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51207==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51207==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51207==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51207==    by 0x11A0DF: main (test_custom.cc:951)
==51207== 
==51207== 
==51207== Use --history-level=approx or =none to gain increased speed, at
==51207== the cost of reduced accuracy of conflicting-access information
==51207== For lists of detected and suppressed errors, rerun with: -s
==51207== ERROR SUMMARY: 9 errors from 7 contexts (suppressed: 196 from 25)
[1;31m❌ FAILED[0m
[32m[C03][0m Multiple wait() calls... ==51213== ---Thread-Announcement------------------------------------------
==51213== 
==51213== Thread #1 is the program's root thread
==51213== 
==51213== ---Thread-Announcement------------------------------------------
==51213== 
==51213== Thread #2 was created
==51213==    at 0x4C3EA23: clone (clone.S:76)
==51213==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51213==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51213==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51213==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51213==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51213==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51213==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51213==    by 0x1149BD: test_multiple_wait_calls() (test_custom.cc:177)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213== 
==51213== ----------------------------------------------------------------
==51213== 
==51213==  Lock at 0x1FFEFFEA48 was first observed
==51213==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51213==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51213==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51213==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51213==    by 0x114A07: test_multiple_wait_calls() (test_custom.cc:179)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51213==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51213==    by 0x11A0DF: main (test_custom.cc:951)
==51213==  Address 0x1ffeffea48 is on thread #1's stack
==51213==  in frame #3, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213==  Lock at 0x1FFEFFEAF0 was first observed
==51213==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51213==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51213==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51213==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51213==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51213==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51213==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51213==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51213==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51213==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51213==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51213==  Address 0x1ffeffeaf0 is on thread #1's stack
==51213==  in frame #3, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51213== Locks held: 1, at address 0x1FFEFFEA48
==51213==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51213==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51213==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51213==    by 0x114A07: test_multiple_wait_calls() (test_custom.cc:179)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51213==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51213==    by 0x11A0DF: main (test_custom.cc:951)
==51213== 
==51213== This conflicts with a previous read of size 8 by thread #2
==51213== Locks held: 1, at address 0x1FFEFFEAF0
==51213==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51213==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51213==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51213==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51213==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51213==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51213==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51213==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51213==  Address 0x1ffeffeaa0 is on thread #1's stack
==51213==  in frame #3, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213== ----------------------------------------------------------------
==51213== 
==51213== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51213==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51213==    by 0x114A07: test_multiple_wait_calls() (test_custom.cc:179)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51213==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51213==    by 0x11A0DF: main (test_custom.cc:951)
==51213== 
==51213== ----------------------------------------------------------------
==51213== 
==51213==  Lock at 0x1FFEFFEA48 was first observed
==51213==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51213==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51213==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51213==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51213==    by 0x114A07: test_multiple_wait_calls() (test_custom.cc:179)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51213==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51213==    by 0x11A0DF: main (test_custom.cc:951)
==51213==  Address 0x1ffeffea48 is on thread #1's stack
==51213==  in frame #5, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213==  Lock at 0x1FFEFFEAF0 was first observed
==51213==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51213==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51213==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51213==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51213==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51213==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51213==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51213==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51213==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51213==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51213==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51213==  Address 0x1ffeffeaf0 is on thread #1's stack
==51213==  in frame #5, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213==  Lock at 0x1FFEFFEB48 was first observed
==51213==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51213==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51213==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51213==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51213==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51213==    by 0x114A25: test_multiple_wait_calls() (test_custom.cc:182)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51213==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51213==  Address 0x1ffeffeb48 is on thread #1's stack
==51213==  in frame #5, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51213== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51213==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51213==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51213==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51213==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51213==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51213==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51213==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51213==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51213==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51213==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51213==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51213== 
==51213== This conflicts with a previous read of size 8 by thread #1
==51213== Locks held: 1, at address 0x1FFEFFEB48
==51213==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51213==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51213==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51213==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51213==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51213==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51213==    by 0x114A25: test_multiple_wait_calls() (test_custom.cc:182)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==  Address 0x1ffeffea80 is on thread #1's stack
==51213==  in frame #5, created by test_multiple_wait_calls() (test_custom.cc:175)
==51213== 
==51213== ---Thread-Announcement------------------------------------------
==51213== 
==51213== Thread #3 was created
==51213==    at 0x4C3EA23: clone (clone.S:76)
==51213==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51213==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51213==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51213==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51213==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51213==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51213==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51213==    by 0x1149BD: test_multiple_wait_calls() (test_custom.cc:177)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213== 
==51213== ----------------------------------------------------------------
==51213== 
==51213== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51213==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51213==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51213==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51213==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51213==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51213==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51213==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51213==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51213==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51213==    by 0x4C3EA33: clone (clone.S:100)
==51213== 
==51213== ----------------------------------------------------------------
==51213== 
==51213== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51213==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51213==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51213==    by 0x114A58: test_multiple_wait_calls() (test_custom.cc:185)
==51213==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51213==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51213==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51213==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51213==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51213==    by 0x11A0DF: main (test_custom.cc:951)
==51213== 
==51213== 
==51213== Use --history-level=approx or =none to gain increased speed, at
==51213== the cost of reduced accuracy of conflicting-access information
==51213== For lists of detected and suppressed errors, rerun with: -s
==51213== ERROR SUMMARY: 5 errors from 5 contexts (suppressed: 145 from 21)
[1;31m❌ FAILED[0m
[35m[E01][0m Massive stress (10k tasks)... ==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #1 is the program's root thread
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #2 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51219==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219==  Lock at 0x1FFEFFEA48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51219==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219==  Address 0x1ffeffea48 is on thread #1's stack
==51219==  in frame #3, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEAF0 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==  Address 0x1ffeffeaf0 is on thread #1's stack
==51219==  in frame #3, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51219== Locks held: 1, at address 0x1FFEFFEA48
==51219==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51219==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51219==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219== 
==51219== This conflicts with a previous read of size 8 by thread #2
==51219== Locks held: 1, at address 0x1FFEFFEAF0
==51219==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51219==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51219==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51219==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51219==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51219==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==  Address 0x1ffeffeaa0 is on thread #1's stack
==51219==  in frame #3, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219==  Lock at 0x1FFEFFEA48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51219==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219==  Address 0x1ffeffea48 is on thread #1's stack
==51219==  in frame #4, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEAF0 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==  Address 0x1ffeffeaf0 is on thread #1's stack
==51219==  in frame #4, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51219== Locks held: 1, at address 0x1FFEFFEA48
==51219==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51219==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51219==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51219==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219== 
==51219== This conflicts with a previous read of size 8 by thread #2
==51219== Locks held: 1, at address 0x1FFEFFEAF0
==51219==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51219==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51219==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51219==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51219==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51219==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==  Address 0x1ffeffeaa0 is on thread #1's stack
==51219==  in frame #4, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219==  Lock at 0x1FFEFFEA48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51219==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219==  Address 0x1ffeffea48 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEAF0 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==  Address 0x1ffeffeaf0 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEB48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51219==    by 0x114BA8: test_massive_stress() (test_custom.cc:204)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==  Address 0x1ffeffeb48 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51219== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51219==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51219==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51219==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219== 
==51219== This conflicts with a previous read of size 8 by thread #1
==51219== Locks held: 1, at address 0x1FFEFFEB48
==51219==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51219==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51219==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51219==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51219==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51219==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51219==    by 0x114BA8: test_massive_stress() (test_custom.cc:204)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==  Address 0x1ffeffea80 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #3 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #5 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #6 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #4 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #7 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #7: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #9 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #9: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #10 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #10: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #12 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #12: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #8 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #8: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #11 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #11: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #13 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #13: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219==  Lock at 0x1FFEFFEA48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51219==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219==  Address 0x1ffeffea48 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEAF0 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==  Address 0x1ffeffeaf0 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEB48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51219==    by 0x114BA8: test_massive_stress() (test_custom.cc:204)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==  Address 0x1ffeffeb48 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51219== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51219==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51219==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51219==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51219==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219== 
==51219== This conflicts with a previous read of size 8 by thread #1
==51219== Locks held: 1, at address 0x1FFEFFEB48
==51219==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51219==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51219==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51219==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51219==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51219==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51219==    by 0x114BA8: test_massive_stress() (test_custom.cc:204)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==  Address 0x1ffeffea80 is on thread #1's stack
==51219==  in frame #5, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #14 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #14: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #15 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #15: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #17 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #17: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #16 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #16: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ---Thread-Announcement------------------------------------------
==51219== 
==51219== Thread #18 was created
==51219==    at 0x4C3EA23: clone (clone.S:76)
==51219==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51219==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51219==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51219==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51219==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51219==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51219==    by 0x114B2B: test_massive_stress() (test_custom.cc:198)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #18: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51219==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51219==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51219==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51219==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51219==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51219==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51219==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51219==    by 0x4C3EA33: clone (clone.S:100)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219==  Lock at 0x1FFEFFEB48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51219==    by 0x114BA8: test_massive_stress() (test_custom.cc:204)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==  Address 0x1ffeffeb48 is on thread #1's stack
==51219==  in frame #6, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEA48 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51219==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51219==    by 0x114B77: test_massive_stress() (test_custom.cc:200)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219==  Address 0x1ffeffea48 is on thread #1's stack
==51219==  in frame #6, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219==  Lock at 0x1FFEFFEAF0 was first observed
==51219==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51219==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51219==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51219==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51219==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51219==  Address 0x1ffeffeaf0 is on thread #1's stack
==51219==  in frame #6, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51219== Locks held: 1, at address 0x1FFEFFEB48
==51219==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51219==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51219==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51219==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51219==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51219==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51219==    by 0x114BA8: test_massive_stress() (test_custom.cc:204)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219== 
==51219== This conflicts with a previous write of size 8 by thread #2
==51219== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51219==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51219==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51219==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51219==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51219==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51219==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51219==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51219==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51219==  Address 0x1ffeffea80 is on thread #1's stack
==51219==  in frame #6, created by test_massive_stress() (test_custom.cc:194)
==51219== 
==51219== ----------------------------------------------------------------
==51219== 
==51219== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51219==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51219==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51219==    by 0x114BCE: test_massive_stress() (test_custom.cc:206)
==51219==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51219==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51219==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51219==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51219==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51219==    by 0x11A0DF: main (test_custom.cc:951)
==51219== 
==51219== 
==51219== Use --history-level=approx or =none to gain increased speed, at
==51219== the cost of reduced accuracy of conflicting-access information
==51219== For lists of detected and suppressed errors, rerun with: -s
==51219== ERROR SUMMARY: 32166 errors from 23 contexts (suppressed: 540122 from 32)
[1;31m❌ FAILED[0m
[35m[E02][0m Long tasks then shutdown... ==51259== ---Thread-Announcement------------------------------------------
==51259== 
==51259== Thread #1 is the program's root thread
==51259== 
==51259== ---Thread-Announcement------------------------------------------
==51259== 
==51259== Thread #2 was created
==51259==    at 0x4C3EA23: clone (clone.S:76)
==51259==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51259==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51259==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51259==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51259==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51259==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51259==    by 0x114C83: test_long_tasks_then_quit() (test_custom.cc:213)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259==  Lock at 0x1FFEFFEA48 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51259==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51259==    by 0x114CC1: test_long_tasks_then_quit() (test_custom.cc:215)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==    by 0x11A0DF: main (test_custom.cc:951)
==51259==  Address 0x1ffeffea48 is on thread #1's stack
==51259==  in frame #3, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259==  Lock at 0x1FFEFFEAF0 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51259==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51259==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51259==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51259==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51259==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51259==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51259==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51259==  Address 0x1ffeffeaf0 is on thread #1's stack
==51259==  in frame #3, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51259== Locks held: 1, at address 0x1FFEFFEA48
==51259==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51259==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51259==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51259==    by 0x114CC1: test_long_tasks_then_quit() (test_custom.cc:215)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==    by 0x11A0DF: main (test_custom.cc:951)
==51259== 
==51259== This conflicts with a previous read of size 8 by thread #2
==51259== Locks held: 1, at address 0x1FFEFFEAF0
==51259==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51259==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51259==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51259==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51259==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51259==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51259==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51259==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51259==  Address 0x1ffeffeaa0 is on thread #1's stack
==51259==  in frame #3, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51259==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51259==    by 0x114CC1: test_long_tasks_then_quit() (test_custom.cc:215)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==    by 0x11A0DF: main (test_custom.cc:951)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259==  Lock at 0x1FFEFFEA48 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51259==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51259==    by 0x114CC1: test_long_tasks_then_quit() (test_custom.cc:215)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==    by 0x11A0DF: main (test_custom.cc:951)
==51259==  Address 0x1ffeffea48 is on thread #1's stack
==51259==  in frame #5, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259==  Lock at 0x1FFEFFEAF0 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51259==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51259==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51259==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51259==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51259==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51259==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51259==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51259==  Address 0x1ffeffeaf0 is on thread #1's stack
==51259==  in frame #5, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259==  Lock at 0x1FFEFFEB48 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51259==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51259==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51259==    by 0x114CEF: test_long_tasks_then_quit() (test_custom.cc:219)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==  Address 0x1ffeffeb48 is on thread #1's stack
==51259==  in frame #5, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51259== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51259==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51259==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51259==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51259==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51259==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51259==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51259==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51259==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51259==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51259== 
==51259== This conflicts with a previous read of size 8 by thread #1
==51259== Locks held: 1, at address 0x1FFEFFEB48
==51259==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51259==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51259==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51259==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51259==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51259==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51259==    by 0x114CEF: test_long_tasks_then_quit() (test_custom.cc:219)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==  Address 0x1ffeffea80 is on thread #1's stack
==51259==  in frame #5, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259== ---Thread-Announcement------------------------------------------
==51259== 
==51259== Thread #5 was created
==51259==    at 0x4C3EA23: clone (clone.S:76)
==51259==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51259==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51259==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51259==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51259==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51259==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51259==    by 0x114C83: test_long_tasks_then_quit() (test_custom.cc:213)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51259==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51259==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51259==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51259==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51259==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51259==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51259==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51259==    by 0x4C3EA33: clone (clone.S:100)
==51259== 
==51259== ---Thread-Announcement------------------------------------------
==51259== 
==51259== Thread #3 was created
==51259==    at 0x4C3EA23: clone (clone.S:76)
==51259==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51259==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51259==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51259==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51259==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51259==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51259==    by 0x114C83: test_long_tasks_then_quit() (test_custom.cc:213)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51259==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51259==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51259==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51259==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51259==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51259==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51259==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51259==    by 0x4C3EA33: clone (clone.S:100)
==51259== 
==51259== ---Thread-Announcement------------------------------------------
==51259== 
==51259== Thread #4 was created
==51259==    at 0x4C3EA23: clone (clone.S:76)
==51259==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51259==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51259==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51259==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51259==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51259==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51259==    by 0x114C83: test_long_tasks_then_quit() (test_custom.cc:213)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51259==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51259==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51259==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51259==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51259==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51259==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51259==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51259==    by 0x4C3EA33: clone (clone.S:100)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259==  Lock at 0x1FFEFFEB48 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51259==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51259==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51259==    by 0x114CEF: test_long_tasks_then_quit() (test_custom.cc:219)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==  Address 0x1ffeffeb48 is on thread #1's stack
==51259==  in frame #6, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259==  Lock at 0x1FFEFFEA48 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51259==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51259==    by 0x114CC1: test_long_tasks_then_quit() (test_custom.cc:215)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==    by 0x11A0DF: main (test_custom.cc:951)
==51259==  Address 0x1ffeffea48 is on thread #1's stack
==51259==  in frame #6, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259==  Lock at 0x1FFEFFEAF0 was first observed
==51259==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51259==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51259==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51259==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51259==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51259==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51259==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51259==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51259==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51259==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51259==  Address 0x1ffeffeaf0 is on thread #1's stack
==51259==  in frame #6, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51259== Locks held: 1, at address 0x1FFEFFEB48
==51259==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51259==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51259==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51259==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51259==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51259==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51259==    by 0x114CEF: test_long_tasks_then_quit() (test_custom.cc:219)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259== 
==51259== This conflicts with a previous write of size 8 by thread #2
==51259== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51259==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51259==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51259==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51259==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51259==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51259==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51259==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51259==  Address 0x1ffeffea80 is on thread #1's stack
==51259==  in frame #6, created by test_long_tasks_then_quit() (test_custom.cc:211)
==51259== 
==51259== ---Thread-Announcement------------------------------------------
==51259== 
==51259== Thread #6 was created
==51259==    at 0x4C3EA23: clone (clone.S:76)
==51259==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51259==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51259==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51259==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51259==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51259==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51259==    by 0x114C83: test_long_tasks_then_quit() (test_custom.cc:213)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51259==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51259==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51259==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51259==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51259==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51259==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51259==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51259==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51259==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51259==    by 0x4C3EA33: clone (clone.S:100)
==51259== 
==51259== ----------------------------------------------------------------
==51259== 
==51259== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51259==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51259==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51259==    by 0x114D03: test_long_tasks_then_quit() (test_custom.cc:221)
==51259==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51259==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51259==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51259==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51259==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51259==    by 0x11A0DF: main (test_custom.cc:951)
==51259== 
==51259== 
==51259== Use --history-level=approx or =none to gain increased speed, at
==51259== the cost of reduced accuracy of conflicting-access information
==51259== For lists of detected and suppressed errors, rerun with: -s
==51259== ERROR SUMMARY: 35 errors from 9 contexts (suppressed: 105975 from 32)
[1;31m❌ FAILED[0m
[35m[E03][0m Lots of short tasks on few threads... ==51265== ---Thread-Announcement------------------------------------------
==51265== 
==51265== Thread #1 is the program's root thread
==51265== 
==51265== ---Thread-Announcement------------------------------------------
==51265== 
==51265== Thread #2 was created
==51265==    at 0x4C3EA23: clone (clone.S:76)
==51265==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51265==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51265==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51265==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51265==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51265==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51265==    by 0x114DCD: test_many_short_tasks_on_few_threads() (test_custom.cc:228)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265==  Lock at 0x1FFEFFEA48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51265==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265==  Address 0x1ffeffea48 is on thread #1's stack
==51265==  in frame #3, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEAF0 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==  Address 0x1ffeffeaf0 is on thread #1's stack
==51265==  in frame #3, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51265== Locks held: 1, at address 0x1FFEFFEA48
==51265==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51265==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51265==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265== 
==51265== This conflicts with a previous read of size 8 by thread #2
==51265== Locks held: 1, at address 0x1FFEFFEAF0
==51265==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51265==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51265==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51265==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51265==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51265==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==  Address 0x1ffeffeaa0 is on thread #1's stack
==51265==  in frame #3, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51265==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265==  Lock at 0x1FFEFFEA48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51265==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265==  Address 0x1ffeffea48 is on thread #1's stack
==51265==  in frame #4, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEAF0 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==  Address 0x1ffeffeaf0 is on thread #1's stack
==51265==  in frame #4, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51265== Locks held: 1, at address 0x1FFEFFEA48
==51265==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51265==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51265==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51265==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265== 
==51265== This conflicts with a previous read of size 8 by thread #2
==51265== Locks held: 1, at address 0x1FFEFFEAF0
==51265==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51265==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51265==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51265==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51265==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51265==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==  Address 0x1ffeffeaa0 is on thread #1's stack
==51265==  in frame #4, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265==  Lock at 0x1FFEFFEA48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51265==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265==  Address 0x1ffeffea48 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEAF0 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==  Address 0x1ffeffeaf0 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEB48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51265==    by 0x114E54: test_many_short_tasks_on_few_threads() (test_custom.cc:236)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==  Address 0x1ffeffeb48 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51265== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51265==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51265==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51265==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51265== 
==51265== This conflicts with a previous read of size 8 by thread #1
==51265== Locks held: 1, at address 0x1FFEFFEB48
==51265==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51265==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51265==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51265==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51265==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51265==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51265==    by 0x114E54: test_many_short_tasks_on_few_threads() (test_custom.cc:236)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==  Address 0x1ffeffea80 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== ---Thread-Announcement------------------------------------------
==51265== 
==51265== Thread #3 was created
==51265==    at 0x4C3EA23: clone (clone.S:76)
==51265==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51265==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51265==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51265==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51265==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51265==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51265==    by 0x114DCD: test_many_short_tasks_on_few_threads() (test_custom.cc:228)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51265==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51265==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51265==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51265==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51265==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51265==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51265==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51265==    by 0x4C3EA33: clone (clone.S:100)
==51265== 
==51265== ---Thread-Announcement------------------------------------------
==51265== 
==51265== Thread #4 was created
==51265==    at 0x4C3EA23: clone (clone.S:76)
==51265==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51265==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51265==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51265==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51265==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51265==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51265==    by 0x114DCD: test_many_short_tasks_on_few_threads() (test_custom.cc:228)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51265==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51265==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51265==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51265==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51265==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51265==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51265==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51265==    by 0x4C3EA33: clone (clone.S:100)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265==  Lock at 0x1FFEFFEB48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51265==    by 0x114E54: test_many_short_tasks_on_few_threads() (test_custom.cc:236)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==  Address 0x1ffeffeb48 is on thread #1's stack
==51265==  in frame #6, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEA48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51265==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265==  Address 0x1ffeffea48 is on thread #1's stack
==51265==  in frame #6, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEAF0 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==  Address 0x1ffeffeaf0 is on thread #1's stack
==51265==  in frame #6, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51265== Locks held: 1, at address 0x1FFEFFEB48
==51265==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51265==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51265==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51265==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51265==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51265==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51265==    by 0x114E54: test_many_short_tasks_on_few_threads() (test_custom.cc:236)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265== 
==51265== This conflicts with a previous write of size 8 by thread #2
==51265== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51265==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51265==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51265==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==  Address 0x1ffeffea80 is on thread #1's stack
==51265==  in frame #6, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265==  Lock at 0x1FFEFFEA48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51265==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51265==    by 0x114E23: test_many_short_tasks_on_few_threads() (test_custom.cc:231)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265==  Address 0x1ffeffea48 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEAF0 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==  Address 0x1ffeffeaf0 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265==  Lock at 0x1FFEFFEB48 was first observed
==51265==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51265==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51265==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51265==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51265==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51265==    by 0x114E54: test_many_short_tasks_on_few_threads() (test_custom.cc:236)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==  Address 0x1ffeffeb48 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51265== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51265==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51265==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51265==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51265==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51265==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51265==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51265==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51265==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51265==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51265==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51265==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51265==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265== 
==51265== This conflicts with a previous read of size 8 by thread #1
==51265== Locks held: 1, at address 0x1FFEFFEB48
==51265==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51265==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51265==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51265==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51265==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51265==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51265==    by 0x114E54: test_many_short_tasks_on_few_threads() (test_custom.cc:236)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==  Address 0x1ffeffea80 is on thread #1's stack
==51265==  in frame #5, created by test_many_short_tasks_on_few_threads() (test_custom.cc:226)
==51265== 
==51265== ----------------------------------------------------------------
==51265== 
==51265== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51265==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51265==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51265==    by 0x114E7A: test_many_short_tasks_on_few_threads() (test_custom.cc:238)
==51265==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51265==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51265==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51265==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51265==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51265==    by 0x11A0DF: main (test_custom.cc:951)
==51265== 
==51265== 
==51265== Use --history-level=approx or =none to gain increased speed, at
==51265== the cost of reduced accuracy of conflicting-access information
==51265== For lists of detected and suppressed errors, rerun with: -s
==51265== ERROR SUMMARY: 694 errors from 9 contexts (suppressed: 121644 from 32)
[1;31m❌ FAILED[0m
[35m[E04][0m Detect potential deadlock... ==51269== ---Thread-Announcement------------------------------------------
==51269== 
==51269== Thread #2 was created
==51269==    at 0x4C3EA23: clone (clone.S:76)
==51269==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51269==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51269==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51269==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51269==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x11B004: std::thread::thread<test_potential_deadlock()::{lambda()#1}, , void>(test_potential_deadlock()::{lambda()#1}&&) (std_thread.h:164)
==51269==    by 0x11532C: test_potential_deadlock() (test_custom.cc:290)
==51269==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51269==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51269==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51269==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51269== 
==51269== ---Thread-Announcement------------------------------------------
==51269== 
==51269== Thread #3 was created
==51269==    at 0x4C3EA23: clone (clone.S:76)
==51269==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51269==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51269==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51269==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51269==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51269==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51269==    by 0x114FC5: test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:251)
==51269==    by 0x127DC7: void std::__invoke_impl<void, test_potential_deadlock()::{lambda()#1}>(std::__invoke_other, test_potential_deadlock()::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x127AEB: std::__invoke_result<test_potential_deadlock()::{lambda()#1}>::type std::__invoke<test_potential_deadlock()::{lambda()#1}>(test_potential_deadlock()::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x127707: void std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269== 
==51269== ----------------------------------------------------------------
==51269== 
==51269==  Lock at 0x5A14C38 was first observed
==51269==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51269==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51269==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51269==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51269==    by 0x115030: test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:254)
==51269==    by 0x127DC7: void std::__invoke_impl<void, test_potential_deadlock()::{lambda()#1}>(std::__invoke_other, test_potential_deadlock()::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x127AEB: std::__invoke_result<test_potential_deadlock()::{lambda()#1}>::type std::__invoke<test_potential_deadlock()::{lambda()#1}>(test_potential_deadlock()::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x127707: void std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269==    by 0x1274F7: std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51269==    by 0x1273A7: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51269==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==  Address 0x5a14c38 is on thread #2's stack
==51269==  in frame #3, created by test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:249)
==51269== 
==51269==  Lock at 0x5A14CE0 was first observed
==51269==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51269==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51269==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51269==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51269==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51269==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51269==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51269==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51269==  Address 0x5a14ce0 is on thread #2's stack
==51269==  in frame #3, created by test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:249)
==51269== 
==51269== Possible data race during write of size 8 at 0x5A14C90 by thread #2
==51269== Locks held: 1, at address 0x5A14C38
==51269==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51269==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51269==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51269==    by 0x115030: test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:254)
==51269==    by 0x127DC7: void std::__invoke_impl<void, test_potential_deadlock()::{lambda()#1}>(std::__invoke_other, test_potential_deadlock()::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x127AEB: std::__invoke_result<test_potential_deadlock()::{lambda()#1}>::type std::__invoke<test_potential_deadlock()::{lambda()#1}>(test_potential_deadlock()::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x127707: void std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269==    by 0x1274F7: std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51269==    by 0x1273A7: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51269==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51269== 
==51269== This conflicts with a previous read of size 8 by thread #3
==51269== Locks held: 1, at address 0x5A14CE0
==51269==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51269==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51269==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51269==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51269==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51269==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51269==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51269==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51269==  Address 0x5a14c90 is on thread #2's stack
==51269==  in frame #3, created by test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:249)
==51269== 
==51269== ----------------------------------------------------------------
==51269== 
==51269== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51269==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51269==    by 0x115030: test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:254)
==51269==    by 0x127DC7: void std::__invoke_impl<void, test_potential_deadlock()::{lambda()#1}>(std::__invoke_other, test_potential_deadlock()::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x127AEB: std::__invoke_result<test_potential_deadlock()::{lambda()#1}>::type std::__invoke<test_potential_deadlock()::{lambda()#1}>(test_potential_deadlock()::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x127707: void std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269==    by 0x1274F7: std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51269==    by 0x1273A7: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51269==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51269==    by 0x4C3EA33: clone (clone.S:100)
==51269== 
==51269== ---Thread-Announcement------------------------------------------
==51269== 
==51269== Thread #4 was created
==51269==    at 0x4C3EA23: clone (clone.S:76)
==51269==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51269==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51269==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51269==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51269==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51269==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51269==    by 0x114FC5: test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:251)
==51269==    by 0x127DC7: void std::__invoke_impl<void, test_potential_deadlock()::{lambda()#1}>(std::__invoke_other, test_potential_deadlock()::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x127AEB: std::__invoke_result<test_potential_deadlock()::{lambda()#1}>::type std::__invoke<test_potential_deadlock()::{lambda()#1}>(test_potential_deadlock()::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x127707: void std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269== 
==51269== ----------------------------------------------------------------
==51269== 
==51269== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51269==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51269==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51269==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51269==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51269==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51269==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51269==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51269==    by 0x4C3EA33: clone (clone.S:100)
==51269== 
==51269== ----------------------------------------------------------------
==51269== 
==51269== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51269==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51269==    by 0x11518A: test_potential_deadlock()::{lambda()#1}::operator()() const (test_custom.cc:283)
==51269==    by 0x127DC7: void std::__invoke_impl<void, test_potential_deadlock()::{lambda()#1}>(std::__invoke_other, test_potential_deadlock()::{lambda()#1}&&) (invoke.h:61)
==51269==    by 0x127AEB: std::__invoke_result<test_potential_deadlock()::{lambda()#1}>::type std::__invoke<test_potential_deadlock()::{lambda()#1}>(test_potential_deadlock()::{lambda()#1}&&) (invoke.h:96)
==51269==    by 0x127707: void std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51269==    by 0x1274F7: std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51269==    by 0x1273A7: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_potential_deadlock()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51269==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51269==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51269==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51269==    by 0x4C3EA33: clone (clone.S:100)
==51269== 
==51269== 
==51269== Use --history-level=approx or =none to gain increased speed, at
==51269== the cost of reduced accuracy of conflicting-access information
==51269== For lists of detected and suppressed errors, rerun with: -s
==51269== ERROR SUMMARY: 4 errors from 4 contexts (suppressed: 126 from 34)
[1;31m❌ FAILED[0m
[35m[E05][0m Simulated pendingTasks tracking... ==51274== ---Thread-Announcement------------------------------------------
==51274== 
==51274== Thread #1 is the program's root thread
==51274== 
==51274== ---Thread-Announcement------------------------------------------
==51274== 
==51274== Thread #2 was created
==51274==    at 0x4C3EA23: clone (clone.S:76)
==51274==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51274==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51274==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51274==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51274==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51274==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51274==    by 0x1154CD: test_pending_tasks_tracking_simulado() (test_custom.cc:306)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274==  Lock at 0x1FFEFFEA48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51274==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274==  Address 0x1ffeffea48 is on thread #1's stack
==51274==  in frame #3, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEAF0 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==  Address 0x1ffeffeaf0 is on thread #1's stack
==51274==  in frame #3, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51274== Locks held: 1, at address 0x1FFEFFEA48
==51274==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51274==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51274==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274== 
==51274== This conflicts with a previous read of size 8 by thread #2
==51274== Locks held: 1, at address 0x1FFEFFEAF0
==51274==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51274==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51274==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51274==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51274==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51274==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==  Address 0x1ffeffeaa0 is on thread #1's stack
==51274==  in frame #3, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51274==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274==  Lock at 0x1FFEFFEA48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51274==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274==  Address 0x1ffeffea48 is on thread #1's stack
==51274==  in frame #4, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEAF0 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==  Address 0x1ffeffeaf0 is on thread #1's stack
==51274==  in frame #4, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51274== Locks held: 1, at address 0x1FFEFFEA48
==51274==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51274==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51274==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51274==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274== 
==51274== This conflicts with a previous read of size 8 by thread #2
==51274== Locks held: 1, at address 0x1FFEFFEAF0
==51274==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51274==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51274==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51274==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51274==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51274==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==  Address 0x1ffeffeaa0 is on thread #1's stack
==51274==  in frame #4, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274==  Lock at 0x1FFEFFEA48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51274==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274==  Address 0x1ffeffea48 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEAF0 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==  Address 0x1ffeffeaf0 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEB48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51274==    by 0x115551: test_pending_tasks_tracking_simulado() (test_custom.cc:316)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==  Address 0x1ffeffeb48 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51274== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51274==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51274==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51274==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51274== 
==51274== This conflicts with a previous read of size 8 by thread #1
==51274== Locks held: 1, at address 0x1FFEFFEB48
==51274==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51274==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51274==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51274==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51274==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51274==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51274==    by 0x115551: test_pending_tasks_tracking_simulado() (test_custom.cc:316)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==  Address 0x1ffeffea80 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== ---Thread-Announcement------------------------------------------
==51274== 
==51274== Thread #3 was created
==51274==    at 0x4C3EA23: clone (clone.S:76)
==51274==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51274==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51274==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51274==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51274==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51274==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51274==    by 0x1154CD: test_pending_tasks_tracking_simulado() (test_custom.cc:306)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51274==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51274==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51274==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51274==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51274==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51274==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51274==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51274==    by 0x4C3EA33: clone (clone.S:100)
==51274== 
==51274== ---Thread-Announcement------------------------------------------
==51274== 
==51274== Thread #4 was created
==51274==    at 0x4C3EA23: clone (clone.S:76)
==51274==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51274==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51274==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51274==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51274==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51274==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51274==    by 0x1154CD: test_pending_tasks_tracking_simulado() (test_custom.cc:306)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51274==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51274==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51274==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51274==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51274==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51274==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51274==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51274==    by 0x4C3EA33: clone (clone.S:100)
==51274== 
==51274== ---Thread-Announcement------------------------------------------
==51274== 
==51274== Thread #5 was created
==51274==    at 0x4C3EA23: clone (clone.S:76)
==51274==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51274==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51274==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51274==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51274==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51274==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51274==    by 0x1154CD: test_pending_tasks_tracking_simulado() (test_custom.cc:306)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51274==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51274==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51274==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51274==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51274==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51274==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51274==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51274==    by 0x4C3EA33: clone (clone.S:100)
==51274== 
==51274== ---Thread-Announcement------------------------------------------
==51274== 
==51274== Thread #6 was created
==51274==    at 0x4C3EA23: clone (clone.S:76)
==51274==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51274==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51274==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51274==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51274==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51274==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51274==    by 0x1154CD: test_pending_tasks_tracking_simulado() (test_custom.cc:306)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51274==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51274==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51274==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51274==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51274==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51274==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51274==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51274==    by 0x4C3EA33: clone (clone.S:100)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274==  Lock at 0x1FFEFFEA48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51274==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274==  Address 0x1ffeffea48 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEAF0 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==  Address 0x1ffeffeaf0 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEB48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51274==    by 0x115551: test_pending_tasks_tracking_simulado() (test_custom.cc:316)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==  Address 0x1ffeffeb48 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51274== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51274==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51274==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51274==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51274==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51274==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274== 
==51274== This conflicts with a previous read of size 8 by thread #1
==51274== Locks held: 1, at address 0x1FFEFFEB48
==51274==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51274==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51274==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51274==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51274==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51274==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51274==    by 0x115551: test_pending_tasks_tracking_simulado() (test_custom.cc:316)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==  Address 0x1ffeffea80 is on thread #1's stack
==51274==  in frame #5, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274==  Lock at 0x1FFEFFEB48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51274==    by 0x115551: test_pending_tasks_tracking_simulado() (test_custom.cc:316)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==  Address 0x1ffeffeb48 is on thread #1's stack
==51274==  in frame #6, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEA48 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51274==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51274==    by 0x115523: test_pending_tasks_tracking_simulado() (test_custom.cc:311)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274==  Address 0x1ffeffea48 is on thread #1's stack
==51274==  in frame #6, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274==  Lock at 0x1FFEFFEAF0 was first observed
==51274==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51274==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51274==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51274==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51274==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51274==  Address 0x1ffeffeaf0 is on thread #1's stack
==51274==  in frame #6, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51274== Locks held: 1, at address 0x1FFEFFEB48
==51274==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51274==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51274==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51274==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51274==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51274==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51274==    by 0x115551: test_pending_tasks_tracking_simulado() (test_custom.cc:316)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274== 
==51274== This conflicts with a previous write of size 8 by thread #2
==51274== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51274==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51274==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51274==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51274==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51274==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51274==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51274==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51274==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51274==  Address 0x1ffeffea80 is on thread #1's stack
==51274==  in frame #6, created by test_pending_tasks_tracking_simulado() (test_custom.cc:304)
==51274== 
==51274== ----------------------------------------------------------------
==51274== 
==51274== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51274==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51274==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51274==    by 0x115575: test_pending_tasks_tracking_simulado() (test_custom.cc:318)
==51274==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51274==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51274==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51274==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51274==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51274==    by 0x11A0DF: main (test_custom.cc:951)
==51274== 
==51274== 
==51274== Use --history-level=approx or =none to gain increased speed, at
==51274== the cost of reduced accuracy of conflicting-access information
==51274== For lists of detected and suppressed errors, rerun with: -s
==51274== ERROR SUMMARY: 328 errors from 11 contexts (suppressed: 52178 from 30)
[1;31m❌ FAILED[0m
[34m[F01][0m Schedule from multiple threads... ==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #11 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x124090: std::thread::thread<test_schedule_from_multiple_threads()::{lambda()#1}, , void>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (std_thread.h:164)
==51280==    by 0x11D943: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (new_allocator.h:191)
==51280==    by 0x11D943: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (alloc_traits.h:538)
==51280==    by 0x11D943: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_schedule_from_multiple_threads()::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:468)
==51280==    by 0x11B336: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:123)
==51280==    by 0x11575B: test_schedule_from_multiple_threads() (test_custom.cc:334)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #2 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51280==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280==  Lock at 0x1FFEFFEA48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffea48 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEAF0 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51280==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51280==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==  Address 0x1ffeffeaf0 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #11
==51280== Locks held: 1, at address 0x1FFEFFEA48
==51280==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51280==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51280==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280== 
==51280== This conflicts with a previous read of size 8 by thread #2
==51280== Locks held: 1, at address 0x1FFEFFEAF0
==51280==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51280==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51280==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51280==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51280==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51280==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==  Address 0x1ffeffeaa0 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #11: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280==  Lock at 0x1FFEFFEA48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffea48 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEAF0 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51280==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51280==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==  Address 0x1ffeffeaf0 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #11
==51280== Locks held: 1, at address 0x1FFEFFEA48
==51280==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51280==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51280==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51280==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280== 
==51280== This conflicts with a previous read of size 8 by thread #2
==51280== Locks held: 1, at address 0x1FFEFFEAF0
==51280==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51280==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51280==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51280==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51280==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51280==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==  Address 0x1ffeffeaa0 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #12 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x124090: std::thread::thread<test_schedule_from_multiple_threads()::{lambda()#1}, , void>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (std_thread.h:164)
==51280==    by 0x11D943: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (new_allocator.h:191)
==51280==    by 0x11D943: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (alloc_traits.h:538)
==51280==    by 0x11D943: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_schedule_from_multiple_threads()::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:468)
==51280==    by 0x11B336: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:123)
==51280==    by 0x11575B: test_schedule_from_multiple_threads() (test_custom.cc:334)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #12: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51280==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280==  Lock at 0x1FFEFFEAF0 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51280==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51280==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==  Address 0x1ffeffeaf0 is on thread #1's stack
==51280==  in frame #8, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEA48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffea48 is on thread #1's stack
==51280==  in frame #8, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== Possible data race during read of size 8 at 0x1FFEFFEAA0 by thread #2
==51280== Locks held: 1, at address 0x1FFEFFEAF0
==51280==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51280==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51280==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51280==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51280==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51280==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280== 
==51280== This conflicts with a previous write of size 8 by thread #12
==51280== Locks held: 1, at address 0x1FFEFFEA48
==51280==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51280==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51280==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==  Address 0x1ffeffeaa0 is on thread #1's stack
==51280==  in frame #8, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #13 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x124090: std::thread::thread<test_schedule_from_multiple_threads()::{lambda()#1}, , void>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (std_thread.h:164)
==51280==    by 0x11D943: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (new_allocator.h:191)
==51280==    by 0x11D943: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (alloc_traits.h:538)
==51280==    by 0x11D943: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_schedule_from_multiple_threads()::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:468)
==51280==    by 0x11B336: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:123)
==51280==    by 0x11575B: test_schedule_from_multiple_threads() (test_custom.cc:334)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #13: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51280==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #14 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x124090: std::thread::thread<test_schedule_from_multiple_threads()::{lambda()#1}, , void>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (std_thread.h:164)
==51280==    by 0x11B2CC: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (new_allocator.h:191)
==51280==    by 0x11B2CC: construct<std::thread, test_schedule_from_multiple_threads()::<lambda()> > (alloc_traits.h:538)
==51280==    by 0x11B2CC: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (vector.tcc:117)
==51280==    by 0x11575B: test_schedule_from_multiple_threads() (test_custom.cc:334)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #14: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51280==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #3 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #1 is the program's root thread
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280==  Lock at 0x1FFEFFEA48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffea48 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEAF0 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51280==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51280==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==  Address 0x1ffeffeaf0 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEB48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffeb48 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51280== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51280==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51280==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51280==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280== 
==51280== This conflicts with a previous read of size 8 by thread #1
==51280== Locks held: 1, at address 0x1FFEFFEB48
==51280==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51280==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51280==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51280==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51280==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51280==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51280==    by 0x115807: test_schedule_from_multiple_threads() (test_custom.cc:343)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==  Address 0x1ffeffea80 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #4 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #5 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280==  Lock at 0x1FFEFFEA48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffea48 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEAF0 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51280==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51280==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==  Address 0x1ffeffeaf0 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEB48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffeb48 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51280== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51280==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51280==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51280==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51280==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280== 
==51280== This conflicts with a previous read of size 8 by thread #1
==51280== Locks held: 1, at address 0x1FFEFFEB48
==51280==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51280==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51280==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51280==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51280==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51280==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51280==    by 0x115807: test_schedule_from_multiple_threads() (test_custom.cc:343)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==  Address 0x1ffeffea80 is on thread #1's stack
==51280==  in frame #5, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #6 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #7 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #7: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #8 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #8: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #9 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #9: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ---Thread-Announcement------------------------------------------
==51280== 
==51280== Thread #10 was created
==51280==    at 0x4C3EA23: clone (clone.S:76)
==51280==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51280==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51280==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51280==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51280==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51280==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51280==    by 0x11570B: test_schedule_from_multiple_threads() (test_custom.cc:331)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #10: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51280==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51280==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51280==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51280==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51280==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51280==    by 0x4C3EA33: clone (clone.S:100)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280==  Lock at 0x1FFEFFEB48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffeb48 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEA48 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51280==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51280==    by 0x11565D: test_schedule_from_multiple_threads()::{lambda()#1}::operator()() const (test_custom.cc:336)
==51280==    by 0x127BDF: void std::__invoke_impl<void, test_schedule_from_multiple_threads()::{lambda()#1}>(std::__invoke_other, test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x127853: std::__invoke_result<test_schedule_from_multiple_threads()::{lambda()#1}>::type std::__invoke<test_schedule_from_multiple_threads()::{lambda()#1}>(test_schedule_from_multiple_threads()::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x1275A7: void std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x127417: std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x127287: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_schedule_from_multiple_threads()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51280==  Address 0x1ffeffea48 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280==  Lock at 0x1FFEFFEAF0 was first observed
==51280==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51280==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51280==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51280==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51280==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51280==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51280==  Address 0x1ffeffeaf0 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51280== Locks held: 1, at address 0x1FFEFFEB48
==51280==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51280==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51280==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51280==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51280==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51280==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51280==    by 0x115807: test_schedule_from_multiple_threads() (test_custom.cc:343)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51280==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51280== 
==51280== This conflicts with a previous write of size 8 by thread #2
==51280== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51280==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51280==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51280==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51280==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51280==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51280==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51280==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51280==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51280==  Address 0x1ffeffea80 is on thread #1's stack
==51280==  in frame #6, created by test_schedule_from_multiple_threads() (test_custom.cc:327)
==51280== 
==51280== ----------------------------------------------------------------
==51280== 
==51280== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51280==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51280==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51280==    by 0x11583C: test_schedule_from_multiple_threads() (test_custom.cc:345)
==51280==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51280==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51280==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51280==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51280==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51280==    by 0x11A0DF: main (test_custom.cc:951)
==51280== 
==51280== 
==51280== Use --history-level=approx or =none to gain increased speed, at
==51280== the cost of reduced accuracy of conflicting-access information
==51280== For lists of detected and suppressed errors, rerun with: -s
==51280== ERROR SUMMARY: 5099 errors from 19 contexts (suppressed: 120772 from 33)
[1;31m❌ FAILED[0m
[34m[F03][0m Schedule inside another task... ==51294== ---Thread-Announcement------------------------------------------
==51294== 
==51294== Thread #1 is the program's root thread
==51294== 
==51294== ---Thread-Announcement------------------------------------------
==51294== 
==51294== Thread #2 was created
==51294==    at 0x4C3EA23: clone (clone.S:76)
==51294==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51294==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51294==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51294==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51294==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51294==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51294==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51294==    by 0x115B64: test_schedule_inside_task() (test_custom.cc:370)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294== 
==51294== ----------------------------------------------------------------
==51294== 
==51294==  Lock at 0x1FFEFFEA48 was first observed
==51294==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51294==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51294==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51294==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51294==    by 0x115BD1: test_schedule_inside_task() (test_custom.cc:374)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51294==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51294==    by 0x11A0DF: main (test_custom.cc:951)
==51294==  Address 0x1ffeffea48 is on thread #1's stack
==51294==  in frame #3, created by test_schedule_inside_task() (test_custom.cc:369)
==51294== 
==51294==  Lock at 0x1FFEFFEAF0 was first observed
==51294==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51294==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51294==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51294==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51294==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51294==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51294==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51294==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51294==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51294==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51294==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51294==  Address 0x1ffeffeaf0 is on thread #1's stack
==51294==  in frame #3, created by test_schedule_inside_task() (test_custom.cc:369)
==51294== 
==51294== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51294== Locks held: 1, at address 0x1FFEFFEA48
==51294==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51294==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51294==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51294==    by 0x115BD1: test_schedule_inside_task() (test_custom.cc:374)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51294==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51294==    by 0x11A0DF: main (test_custom.cc:951)
==51294== 
==51294== This conflicts with a previous read of size 8 by thread #2
==51294== Locks held: 1, at address 0x1FFEFFEAF0
==51294==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51294==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51294==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51294==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51294==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51294==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51294==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51294==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51294==  Address 0x1ffeffeaa0 is on thread #1's stack
==51294==  in frame #3, created by test_schedule_inside_task() (test_custom.cc:369)
==51294== 
==51294== ----------------------------------------------------------------
==51294== 
==51294== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51294==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51294==    by 0x115BD1: test_schedule_inside_task() (test_custom.cc:374)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51294==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51294==    by 0x11A0DF: main (test_custom.cc:951)
==51294== 
==51294== ---Thread-Announcement------------------------------------------
==51294== 
==51294== Thread #3 was created
==51294==    at 0x4C3EA23: clone (clone.S:76)
==51294==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51294==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51294==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51294==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51294==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51294==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51294==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51294==    by 0x115B64: test_schedule_inside_task() (test_custom.cc:370)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294== 
==51294== ----------------------------------------------------------------
==51294== 
==51294==  Lock at 0x1FFEFFEA48 was first observed
==51294==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51294==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51294==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51294==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51294==    by 0x115BD1: test_schedule_inside_task() (test_custom.cc:374)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51294==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51294==    by 0x11A0DF: main (test_custom.cc:951)
==51294==  Address 0x1ffeffea48 is on thread #1's stack
==51294==  in frame #3, created by test_schedule_inside_task() (test_custom.cc:369)
==51294== 
==51294==  Lock at 0x1FFEFFEAF0 was first observed
==51294==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51294==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51294==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51294==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51294==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51294==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51294==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51294==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51294==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51294==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51294==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51294==  Address 0x1ffeffeaf0 is on thread #1's stack
==51294==  in frame #3, created by test_schedule_inside_task() (test_custom.cc:369)
==51294== 
==51294== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #3
==51294== Locks held: 1, at address 0x1FFEFFEA48
==51294==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51294==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51294==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51294==    by 0x115AD6: test_schedule_inside_task()::{lambda()#1}::operator()() const (test_custom.cc:376)
==51294==    by 0x124341: void std::__invoke_impl<void, test_schedule_inside_task()::{lambda()#1}&>(std::__invoke_other, test_schedule_inside_task()::{lambda()#1}&) (invoke.h:61)
==51294==    by 0x121B2F: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_schedule_inside_task()::{lambda()#1}&>(test_schedule_inside_task()::{lambda()#1}&) (invoke.h:150)
==51294==    by 0x11DFDC: std::_Function_handler<void (), test_schedule_inside_task()::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51294==    by 0x10E5B4: ThreadPool::worker(int) (thread-pool.cc:95)
==51294==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51294==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51294==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51294== 
==51294== This conflicts with a previous read of size 8 by thread #2
==51294== Locks held: 1, at address 0x1FFEFFEAF0
==51294==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51294==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51294==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51294==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51294==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51294==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51294==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51294==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51294==  Address 0x1ffeffeaa0 is on thread #1's stack
==51294==  in frame #3, created by test_schedule_inside_task() (test_custom.cc:369)
==51294== 
==51294== ----------------------------------------------------------------
==51294== 
==51294== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51294==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51294==    by 0x115AD6: test_schedule_inside_task()::{lambda()#1}::operator()() const (test_custom.cc:376)
==51294==    by 0x124341: void std::__invoke_impl<void, test_schedule_inside_task()::{lambda()#1}&>(std::__invoke_other, test_schedule_inside_task()::{lambda()#1}&) (invoke.h:61)
==51294==    by 0x121B2F: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_schedule_inside_task()::{lambda()#1}&>(test_schedule_inside_task()::{lambda()#1}&) (invoke.h:150)
==51294==    by 0x11DFDC: std::_Function_handler<void (), test_schedule_inside_task()::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51294==    by 0x10E5B4: ThreadPool::worker(int) (thread-pool.cc:95)
==51294==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51294==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51294==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51294==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51294== 
==51294== ----------------------------------------------------------------
==51294== 
==51294== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51294==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51294==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51294==    by 0x115CA0: test_schedule_inside_task() (test_custom.cc:390)
==51294==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51294==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51294==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51294==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51294==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51294==    by 0x11A0DF: main (test_custom.cc:951)
==51294== 
==51294== 
==51294== Use --history-level=approx or =none to gain increased speed, at
==51294== the cost of reduced accuracy of conflicting-access information
==51294== For lists of detected and suppressed errors, rerun with: -s
==51294== ERROR SUMMARY: 5 errors from 5 contexts (suppressed: 203 from 26)
[1;31m❌ FAILED[0m
[34m[F04][0m Wait blocks until all tasks finish... ==51300== ---Thread-Announcement------------------------------------------
==51300== 
==51300== Thread #1 is the program's root thread
==51300== 
==51300== ---Thread-Announcement------------------------------------------
==51300== 
==51300== Thread #2 was created
==51300==    at 0x4C3EA23: clone (clone.S:76)
==51300==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51300==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51300==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51300==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51300==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51300==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51300==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51300==    by 0x115D6B: test_wait_blocks_until_finish() (test_custom.cc:394)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300== 
==51300== ----------------------------------------------------------------
==51300== 
==51300==  Lock at 0x1FFEFFEA48 was first observed
==51300==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51300==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51300==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51300==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51300==    by 0x115DB2: test_wait_blocks_until_finish() (test_custom.cc:398)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51300==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51300==    by 0x11A0DF: main (test_custom.cc:951)
==51300==  Address 0x1ffeffea48 is on thread #1's stack
==51300==  in frame #3, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300==  Lock at 0x1FFEFFEAF0 was first observed
==51300==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51300==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51300==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51300==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51300==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51300==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51300==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51300==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51300==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51300==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51300==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51300==  Address 0x1ffeffeaf0 is on thread #1's stack
==51300==  in frame #3, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51300== Locks held: 1, at address 0x1FFEFFEA48
==51300==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51300==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51300==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51300==    by 0x115DB2: test_wait_blocks_until_finish() (test_custom.cc:398)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51300==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51300==    by 0x11A0DF: main (test_custom.cc:951)
==51300== 
==51300== This conflicts with a previous read of size 8 by thread #2
==51300== Locks held: 1, at address 0x1FFEFFEAF0
==51300==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51300==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51300==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51300==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51300==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51300==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51300==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51300==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51300==  Address 0x1ffeffeaa0 is on thread #1's stack
==51300==  in frame #3, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300== ----------------------------------------------------------------
==51300== 
==51300== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51300==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51300==    by 0x115DB2: test_wait_blocks_until_finish() (test_custom.cc:398)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51300==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51300==    by 0x11A0DF: main (test_custom.cc:951)
==51300== 
==51300== ----------------------------------------------------------------
==51300== 
==51300==  Lock at 0x1FFEFFEA48 was first observed
==51300==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51300==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51300==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51300==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51300==    by 0x115DB2: test_wait_blocks_until_finish() (test_custom.cc:398)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51300==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51300==    by 0x11A0DF: main (test_custom.cc:951)
==51300==  Address 0x1ffeffea48 is on thread #1's stack
==51300==  in frame #5, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300==  Lock at 0x1FFEFFEAF0 was first observed
==51300==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51300==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51300==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51300==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51300==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51300==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51300==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51300==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51300==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51300==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51300==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51300==  Address 0x1ffeffeaf0 is on thread #1's stack
==51300==  in frame #5, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300==  Lock at 0x1FFEFFEB48 was first observed
==51300==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51300==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51300==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51300==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51300==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51300==    by 0x115DD0: test_wait_blocks_until_finish() (test_custom.cc:402)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51300==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51300==  Address 0x1ffeffeb48 is on thread #1's stack
==51300==  in frame #5, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51300== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51300==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51300==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51300==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51300==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51300==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51300==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51300==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51300==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51300==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51300==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51300==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51300== 
==51300== This conflicts with a previous read of size 8 by thread #1
==51300== Locks held: 1, at address 0x1FFEFFEB48
==51300==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51300==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51300==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51300==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51300==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51300==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51300==    by 0x115DD0: test_wait_blocks_until_finish() (test_custom.cc:402)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==  Address 0x1ffeffea80 is on thread #1's stack
==51300==  in frame #5, created by test_wait_blocks_until_finish() (test_custom.cc:392)
==51300== 
==51300== ---Thread-Announcement------------------------------------------
==51300== 
==51300== Thread #3 was created
==51300==    at 0x4C3EA23: clone (clone.S:76)
==51300==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51300==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51300==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51300==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51300==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51300==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51300==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51300==    by 0x115D6B: test_wait_blocks_until_finish() (test_custom.cc:394)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300== 
==51300== ----------------------------------------------------------------
==51300== 
==51300== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51300==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51300==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51300==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51300==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51300==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51300==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51300==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51300==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51300==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51300==    by 0x4C3EA33: clone (clone.S:100)
==51300== 
==51300== ----------------------------------------------------------------
==51300== 
==51300== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51300==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51300==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51300==    by 0x115DF6: test_wait_blocks_until_finish() (test_custom.cc:404)
==51300==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51300==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51300==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51300==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51300==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51300==    by 0x11A0DF: main (test_custom.cc:951)
==51300== 
==51300== 
==51300== Use --history-level=approx or =none to gain increased speed, at
==51300== the cost of reduced accuracy of conflicting-access information
==51300== For lists of detected and suppressed errors, rerun with: -s
==51300== ERROR SUMMARY: 5 errors from 5 contexts (suppressed: 101 from 21)
[1;31m❌ FAILED[0m
[34m[F06][0m Many waits in parallel... ==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #1 is the program's root thread
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #2 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51304==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51304==    by 0x115F69: test_many_waits_during_execution() (test_custom.cc:411)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304==  Lock at 0x1FFEFFEA48 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51304==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304==  Address 0x1ffeffea48 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304==  Lock at 0x1FFEFFEAF0 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51304==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51304==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51304==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51304==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51304==  Address 0x1ffeffeaf0 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51304== Locks held: 1, at address 0x1FFEFFEA48
==51304==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51304==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51304==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304== 
==51304== This conflicts with a previous read of size 8 by thread #2
==51304== Locks held: 1, at address 0x1FFEFFEAF0
==51304==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51304==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51304==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51304==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51304==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51304==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==  Address 0x1ffeffeaa0 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51304==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304==  Lock at 0x1FFEFFEA48 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51304==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304==  Address 0x1ffeffea48 is on thread #1's stack
==51304==  in frame #4, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304==  Lock at 0x1FFEFFEAF0 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51304==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51304==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51304==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51304==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51304==  Address 0x1ffeffeaf0 is on thread #1's stack
==51304==  in frame #4, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51304== Locks held: 1, at address 0x1FFEFFEA48
==51304==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51304==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51304==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51304==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304== 
==51304== This conflicts with a previous read of size 8 by thread #2
==51304== Locks held: 1, at address 0x1FFEFFEAF0
==51304==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51304==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51304==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51304==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51304==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51304==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==  Address 0x1ffeffeaa0 is on thread #1's stack
==51304==  in frame #4, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #11 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x124576: std::thread::thread<test_many_waits_during_execution()::{lambda()#2}, , void>(test_many_waits_during_execution()::{lambda()#2}&&) (std_thread.h:164)
==51304==    by 0x11E3DF: construct<std::thread, test_many_waits_during_execution()::<lambda()> > (new_allocator.h:191)
==51304==    by 0x11E3DF: construct<std::thread, test_many_waits_during_execution()::<lambda()> > (alloc_traits.h:538)
==51304==    by 0x11E3DF: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_many_waits_during_execution()::{lambda()#2}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_many_waits_during_execution()::{lambda()#2}&&) (vector.tcc:468)
==51304==    by 0x11B7AC: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_many_waits_during_execution()::{lambda()#2}>(test_many_waits_during_execution()::{lambda()#2}&&) (vector.tcc:123)
==51304==    by 0x116088: test_many_waits_during_execution() (test_custom.cc:427)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304==  Lock at 0x1FFEFFEA48 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51304==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304==  Address 0x1ffeffea48 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304==  Lock at 0x1FFEFFEAF0 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51304==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51304==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51304==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51304==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51304==  Address 0x1ffeffeaf0 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304==  Lock at 0x1FFEFFEB48 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51304==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51304==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51304==    by 0x115EA8: test_many_waits_during_execution()::{lambda()#2}::operator()() const (test_custom.cc:429)
==51304==    by 0x127BA2: void std::__invoke_impl<void, test_many_waits_during_execution()::{lambda()#2}>(std::__invoke_other, test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x127800: std::__invoke_result<test_many_waits_during_execution()::{lambda()#2}>::type std::__invoke<test_many_waits_during_execution()::{lambda()#2}>(test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x12757B: void std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x1273FB: std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x127263: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304==  Address 0x1ffeffeb48 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51304== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51304==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51304==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51304==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51304==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51304==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51304==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51304== 
==51304== This conflicts with a previous read of size 8 by thread #11
==51304== Locks held: 1, at address 0x1FFEFFEB48
==51304==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51304==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51304==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51304==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51304==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51304==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51304==    by 0x115EA8: test_many_waits_during_execution()::{lambda()#2}::operator()() const (test_custom.cc:429)
==51304==    by 0x127BA2: void std::__invoke_impl<void, test_many_waits_during_execution()::{lambda()#2}>(std::__invoke_other, test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:61)
==51304==  Address 0x1ffeffea80 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #3 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51304==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51304==    by 0x115F69: test_many_waits_during_execution() (test_custom.cc:411)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51304==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51304==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51304==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51304==    by 0x4C3EA33: clone (clone.S:100)
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #4 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51304==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51304==    by 0x115F69: test_many_waits_during_execution() (test_custom.cc:411)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51304==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51304==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51304==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51304==    by 0x4C3EA33: clone (clone.S:100)
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #8 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x124576: std::thread::thread<test_many_waits_during_execution()::{lambda()#2}, , void>(test_many_waits_during_execution()::{lambda()#2}&&) (std_thread.h:164)
==51304==    by 0x11E3DF: construct<std::thread, test_many_waits_during_execution()::<lambda()> > (new_allocator.h:191)
==51304==    by 0x11E3DF: construct<std::thread, test_many_waits_during_execution()::<lambda()> > (alloc_traits.h:538)
==51304==    by 0x11E3DF: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_many_waits_during_execution()::{lambda()#2}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_many_waits_during_execution()::{lambda()#2}&&) (vector.tcc:468)
==51304==    by 0x11B7AC: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_many_waits_during_execution()::{lambda()#2}>(test_many_waits_during_execution()::{lambda()#2}&&) (vector.tcc:123)
==51304==    by 0x116088: test_many_waits_during_execution() (test_custom.cc:427)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304==  Lock at 0x1FFEFFEB48 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51304==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51304==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51304==    by 0x115EA8: test_many_waits_during_execution()::{lambda()#2}::operator()() const (test_custom.cc:429)
==51304==    by 0x127BA2: void std::__invoke_impl<void, test_many_waits_during_execution()::{lambda()#2}>(std::__invoke_other, test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x127800: std::__invoke_result<test_many_waits_during_execution()::{lambda()#2}>::type std::__invoke<test_many_waits_during_execution()::{lambda()#2}>(test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x12757B: void std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x1273FB: std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x127263: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304==  Address 0x1ffeffeb48 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304==  Lock at 0x1FFEFFEA48 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51304==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51304==    by 0x115FBF: test_many_waits_during_execution() (test_custom.cc:415)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304==  Address 0x1ffeffea48 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304==  Lock at 0x1FFEFFEAF0 was first observed
==51304==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51304==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51304==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51304==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51304==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51304==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51304==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51304==  Address 0x1ffeffeaf0 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #8
==51304== Locks held: 1, at address 0x1FFEFFEB48
==51304==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51304==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51304==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51304==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51304==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51304==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51304==    by 0x115EA8: test_many_waits_during_execution()::{lambda()#2}::operator()() const (test_custom.cc:429)
==51304==    by 0x127BA2: void std::__invoke_impl<void, test_many_waits_during_execution()::{lambda()#2}>(std::__invoke_other, test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x127800: std::__invoke_result<test_many_waits_during_execution()::{lambda()#2}>::type std::__invoke<test_many_waits_during_execution()::{lambda()#2}>(test_many_waits_during_execution()::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x12757B: void std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x1273FB: std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x127263: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_many_waits_during_execution()::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304== 
==51304== This conflicts with a previous write of size 8 by thread #2
==51304== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51304==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51304==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51304==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51304==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51304==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51304==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51304==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51304==  Address 0x1ffeffea80 is on thread #1's stack
==51304==  in frame #3, created by test_many_waits_during_execution() (test_custom.cc:409)
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #6 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51304==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51304==    by 0x115F69: test_many_waits_during_execution() (test_custom.cc:411)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51304==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51304==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51304==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51304==    by 0x4C3EA33: clone (clone.S:100)
==51304== 
==51304== ---Thread-Announcement------------------------------------------
==51304== 
==51304== Thread #5 was created
==51304==    at 0x4C3EA23: clone (clone.S:76)
==51304==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51304==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51304==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51304==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51304==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51304==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51304==    by 0x115F69: test_many_waits_during_execution() (test_custom.cc:411)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51304==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51304==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51304==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51304==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51304==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51304==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51304==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51304==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51304==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51304==    by 0x4C3EA33: clone (clone.S:100)
==51304== 
==51304== ----------------------------------------------------------------
==51304== 
==51304== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51304==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51304==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51304==    by 0x116288: test_many_waits_during_execution() (test_custom.cc:449)
==51304==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51304==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51304==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51304==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51304==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51304==    by 0x11A0DF: main (test_custom.cc:951)
==51304== 
==51304== 
==51304== Use --history-level=approx or =none to gain increased speed, at
==51304== the cost of reduced accuracy of conflicting-access information
==51304== For lists of detected and suppressed errors, rerun with: -s
==51304== ERROR SUMMARY: 240 errors from 10 contexts (suppressed: 48993 from 35)
[1;31m❌ FAILED[0m
[34m[F07][0m High contention on atomic counter... ==51315== ---Thread-Announcement------------------------------------------
==51315== 
==51315== Thread #1 is the program's root thread
==51315== 
==51315== ---Thread-Announcement------------------------------------------
==51315== 
==51315== Thread #2 was created
==51315==    at 0x4C3EA23: clone (clone.S:76)
==51315==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51315==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51315==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51315==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51315==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51315==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51315==    by 0x116363: test_high_contention_atomic_updates() (test_custom.cc:456)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315==  Lock at 0x1FFEFFEA48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51315==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315==  Address 0x1ffeffea48 is on thread #1's stack
==51315==  in frame #3, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEAF0 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==  Address 0x1ffeffeaf0 is on thread #1's stack
==51315==  in frame #3, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51315== Locks held: 1, at address 0x1FFEFFEA48
==51315==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51315==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51315==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315== 
==51315== This conflicts with a previous read of size 8 by thread #2
==51315== Locks held: 1, at address 0x1FFEFFEAF0
==51315==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51315==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51315==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51315==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51315==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51315==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==  Address 0x1ffeffeaa0 is on thread #1's stack
==51315==  in frame #3, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51315==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315==  Lock at 0x1FFEFFEA48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51315==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315==  Address 0x1ffeffea48 is on thread #1's stack
==51315==  in frame #4, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEAF0 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==  Address 0x1ffeffeaf0 is on thread #1's stack
==51315==  in frame #4, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51315== Locks held: 1, at address 0x1FFEFFEA48
==51315==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51315==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51315==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51315==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315== 
==51315== This conflicts with a previous read of size 8 by thread #2
==51315== Locks held: 1, at address 0x1FFEFFEAF0
==51315==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51315==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51315==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51315==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51315==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51315==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==  Address 0x1ffeffeaa0 is on thread #1's stack
==51315==  in frame #4, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315==  Lock at 0x1FFEFFEA48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51315==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315==  Address 0x1ffeffea48 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEAF0 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==  Address 0x1ffeffeaf0 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEB48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51315==    by 0x1163EA: test_high_contention_atomic_updates() (test_custom.cc:465)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==  Address 0x1ffeffeb48 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51315== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51315==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51315==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51315==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51315== 
==51315== This conflicts with a previous read of size 8 by thread #1
==51315== Locks held: 1, at address 0x1FFEFFEB48
==51315==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51315==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51315==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51315==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51315==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51315==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51315==    by 0x1163EA: test_high_contention_atomic_updates() (test_custom.cc:465)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==  Address 0x1ffeffea80 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== ---Thread-Announcement------------------------------------------
==51315== 
==51315== Thread #3 was created
==51315==    at 0x4C3EA23: clone (clone.S:76)
==51315==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51315==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51315==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51315==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51315==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51315==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51315==    by 0x116363: test_high_contention_atomic_updates() (test_custom.cc:456)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51315==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51315==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51315==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51315==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51315==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51315==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51315==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51315==    by 0x4C3EA33: clone (clone.S:100)
==51315== 
==51315== ---Thread-Announcement------------------------------------------
==51315== 
==51315== Thread #5 was created
==51315==    at 0x4C3EA23: clone (clone.S:76)
==51315==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51315==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51315==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51315==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51315==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51315==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51315==    by 0x116363: test_high_contention_atomic_updates() (test_custom.cc:456)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51315==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51315==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51315==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51315==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51315==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51315==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51315==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51315==    by 0x4C3EA33: clone (clone.S:100)
==51315== 
==51315== ---Thread-Announcement------------------------------------------
==51315== 
==51315== Thread #4 was created
==51315==    at 0x4C3EA23: clone (clone.S:76)
==51315==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51315==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51315==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51315==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51315==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51315==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51315==    by 0x116363: test_high_contention_atomic_updates() (test_custom.cc:456)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51315==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51315==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51315==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51315==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51315==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51315==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51315==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51315==    by 0x4C3EA33: clone (clone.S:100)
==51315== 
==51315== ---Thread-Announcement------------------------------------------
==51315== 
==51315== Thread #6 was created
==51315==    at 0x4C3EA23: clone (clone.S:76)
==51315==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51315==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51315==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51315==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51315==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51315==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51315==    by 0x116363: test_high_contention_atomic_updates() (test_custom.cc:456)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51315==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51315==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51315==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51315==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51315==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51315==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51315==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51315==    by 0x4C3EA33: clone (clone.S:100)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315==  Lock at 0x1FFEFFEB48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51315==    by 0x1163EA: test_high_contention_atomic_updates() (test_custom.cc:465)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==  Address 0x1ffeffeb48 is on thread #1's stack
==51315==  in frame #6, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEA48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51315==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315==  Address 0x1ffeffea48 is on thread #1's stack
==51315==  in frame #6, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEAF0 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==  Address 0x1ffeffeaf0 is on thread #1's stack
==51315==  in frame #6, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51315== Locks held: 1, at address 0x1FFEFFEB48
==51315==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51315==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51315==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51315==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51315==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51315==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51315==    by 0x1163EA: test_high_contention_atomic_updates() (test_custom.cc:465)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315== 
==51315== This conflicts with a previous write of size 8 by thread #2
==51315== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51315==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51315==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51315==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==  Address 0x1ffeffea80 is on thread #1's stack
==51315==  in frame #6, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315==  Lock at 0x1FFEFFEA48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51315==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51315==    by 0x1163B9: test_high_contention_atomic_updates() (test_custom.cc:461)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315==  Address 0x1ffeffea48 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEAF0 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==  Address 0x1ffeffeaf0 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315==  Lock at 0x1FFEFFEB48 was first observed
==51315==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51315==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51315==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51315==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51315==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51315==    by 0x1163EA: test_high_contention_atomic_updates() (test_custom.cc:465)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==  Address 0x1ffeffeb48 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51315== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51315==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51315==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51315==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51315==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51315==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51315==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51315==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51315==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51315==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51315==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51315==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51315==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315== 
==51315== This conflicts with a previous read of size 8 by thread #1
==51315== Locks held: 1, at address 0x1FFEFFEB48
==51315==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51315==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51315==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51315==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51315==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51315==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51315==    by 0x1163EA: test_high_contention_atomic_updates() (test_custom.cc:465)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==  Address 0x1ffeffea80 is on thread #1's stack
==51315==  in frame #5, created by test_high_contention_atomic_updates() (test_custom.cc:454)
==51315== 
==51315== ----------------------------------------------------------------
==51315== 
==51315== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51315==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51315==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51315==    by 0x116410: test_high_contention_atomic_updates() (test_custom.cc:467)
==51315==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51315==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51315==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51315==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51315==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51315==    by 0x11A0DF: main (test_custom.cc:951)
==51315== 
==51315== 
==51315== Use --history-level=approx or =none to gain increased speed, at
==51315== the cost of reduced accuracy of conflicting-access information
==51315== For lists of detected and suppressed errors, rerun with: -s
==51315== ERROR SUMMARY: 3344 errors from 11 contexts (suppressed: 54688 from 32)
[1;31m❌ FAILED[0m
[34m[F08][0m Destroy pool immediately after scheduling... ==51321== ---Thread-Announcement------------------------------------------
==51321== 
==51321== Thread #1 is the program's root thread
==51321== 
==51321== ---Thread-Announcement------------------------------------------
==51321== 
==51321== Thread #2 was created
==51321==    at 0x4C3EA23: clone (clone.S:76)
==51321==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51321==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51321==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51321==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51321==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51321==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51321==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51321==    by 0x1164D2: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321==  Lock at 0x4E27138 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51321==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51321==    by 0x116505: test_immediate_destruction_after_schedule() (test_custom.cc:476)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Address 0x4e27138 is 40 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321==  Lock at 0x4E271E0 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51321==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51321==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51321==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51321==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51321==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51321==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51321==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51321==  Address 0x4e271e0 is 208 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321== Possible data race during write of size 8 at 0x4E27190 by thread #1
==51321== Locks held: 1, at address 0x4E27138
==51321==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51321==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51321==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51321==    by 0x116505: test_immediate_destruction_after_schedule() (test_custom.cc:476)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321== 
==51321== This conflicts with a previous read of size 8 by thread #2
==51321== Locks held: 1, at address 0x4E271E0
==51321==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51321==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51321==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51321==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51321==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51321==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51321==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51321==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51321==  Address 0x4e27190 is 128 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51321==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51321==    by 0x116505: test_immediate_destruction_after_schedule() (test_custom.cc:476)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321==  Lock at 0x4E27138 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51321==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51321==    by 0x116505: test_immediate_destruction_after_schedule() (test_custom.cc:476)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Address 0x4e27138 is 40 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321==  Lock at 0x4E271E0 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51321==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51321==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51321==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51321==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51321==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51321==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51321==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51321==  Address 0x4e271e0 is 208 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321==  Lock at 0x4E27238 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51321==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51321==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51321==    by 0x10E852: ThreadPool::~ThreadPool() (thread-pool.cc:123)
==51321==    by 0x11652C: test_immediate_destruction_after_schedule() (test_custom.cc:480)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==  Address 0x4e27238 is 296 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321== Possible data race during write of size 8 at 0x4E27170 by thread #2
==51321== Locks held: 2, at addresses 0x4E27138 0x4E271E0
==51321==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51321==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51321==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51321==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51321==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51321==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51321==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51321==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51321==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51321==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51321== 
==51321== This conflicts with a previous read of size 8 by thread #1
==51321== Locks held: 1, at address 0x4E27238
==51321==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51321==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51321==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51321==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51321==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51321==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51321==    by 0x10E852: ThreadPool::~ThreadPool() (thread-pool.cc:123)
==51321==    by 0x11652C: test_immediate_destruction_after_schedule() (test_custom.cc:480)
==51321==  Address 0x4e27170 is 96 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321== ---Thread-Announcement------------------------------------------
==51321== 
==51321== Thread #3 was created
==51321==    at 0x4C3EA23: clone (clone.S:76)
==51321==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51321==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51321==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51321==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51321==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51321==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51321==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51321==    by 0x1164D2: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51321==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51321==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51321==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51321==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51321==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51321==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51321==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51321==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51321==    by 0x4C3EA33: clone (clone.S:100)
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321==  Lock at 0x4E27238 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51321==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51321==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51321==    by 0x10E852: ThreadPool::~ThreadPool() (thread-pool.cc:123)
==51321==    by 0x11652C: test_immediate_destruction_after_schedule() (test_custom.cc:480)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==  Address 0x4e27238 is 296 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321==  Lock at 0x4E27138 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51321==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51321==    by 0x116505: test_immediate_destruction_after_schedule() (test_custom.cc:476)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Address 0x4e27138 is 40 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321==  Lock at 0x4E271E0 was first observed
==51321==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51321==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51321==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51321==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51321==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51321==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51321==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51321==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51321==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51321==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51321==  Address 0x4e271e0 is 208 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321== Possible data race during read of size 8 at 0x4E27170 by thread #1
==51321== Locks held: 1, at address 0x4E27238
==51321==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51321==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51321==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51321==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51321==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51321==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51321==    by 0x10E852: ThreadPool::~ThreadPool() (thread-pool.cc:123)
==51321==    by 0x11652C: test_immediate_destruction_after_schedule() (test_custom.cc:480)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321== 
==51321== This conflicts with a previous write of size 8 by thread #2
==51321== Locks held: 2, at addresses 0x4E27138 0x4E271E0
==51321==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51321==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51321==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51321==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51321==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51321==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51321==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51321==  Address 0x4e27170 is 96 bytes inside a block of size 360 alloc'd
==51321==    at 0x4849023: operator new(unsigned long) (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x1164BC: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321==  Block was alloc'd by thread #1
==51321== 
==51321== ---Thread-Announcement------------------------------------------
==51321== 
==51321== Thread #4 was created
==51321==    at 0x4C3EA23: clone (clone.S:76)
==51321==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51321==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51321==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51321==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51321==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51321==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51321==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51321==    by 0x1164D2: test_immediate_destruction_after_schedule() (test_custom.cc:474)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51321==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51321==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51321==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51321==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51321==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51321==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51321==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51321==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51321==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51321==    by 0x4C3EA33: clone (clone.S:100)
==51321== 
==51321== ----------------------------------------------------------------
==51321== 
==51321== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51321==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51321==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51321==    by 0x11652C: test_immediate_destruction_after_schedule() (test_custom.cc:480)
==51321==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51321==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51321==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51321==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51321==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51321==    by 0x11A0DF: main (test_custom.cc:951)
==51321== 
==51321== 
==51321== Use --history-level=approx or =none to gain increased speed, at
==51321== the cost of reduced accuracy of conflicting-access information
==51321== For lists of detected and suppressed errors, rerun with: -s
==51321== ERROR SUMMARY: 39 errors from 7 contexts (suppressed: 36542 from 30)
[1;31m❌ FAILED[0m
[34m[F09][0m Interleaved schedule/wait execution... ==51325== ---Thread-Announcement------------------------------------------
==51325== 
==51325== Thread #2 was created
==51325==    at 0x4C3EA23: clone (clone.S:76)
==51325==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51325==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51325==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51325==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51325==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x11BA08: std::thread::thread<test_massive_schedule_wait_interleave()::{lambda()#1}, , void>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (std_thread.h:164)
==51325==    by 0x1167B4: test_massive_schedule_wait_interleave() (test_custom.cc:507)
==51325==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51325==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51325==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51325==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51325== 
==51325== ---Thread-Announcement------------------------------------------
==51325== 
==51325== Thread #3 was created
==51325==    at 0x4C3EA23: clone (clone.S:76)
==51325==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51325==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51325==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51325==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51325==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51325==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51325==    by 0x116609: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:493)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325==  Lock at 0x5A14C38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51325==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==  Address 0x5a14c38 is on thread #2's stack
==51325==  in frame #3, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14CE0 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14ce0 is on thread #2's stack
==51325==  in frame #3, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== Possible data race during write of size 8 at 0x5A14C90 by thread #2
==51325== Locks held: 1, at address 0x5A14C38
==51325==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51325==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51325==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51325== 
==51325== This conflicts with a previous read of size 8 by thread #3
==51325== Locks held: 1, at address 0x5A14CE0
==51325==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51325==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51325==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51325==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51325==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51325==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==  Address 0x5a14c90 is on thread #2's stack
==51325==  in frame #3, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51325==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51325==    by 0x4C3EA33: clone (clone.S:100)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325==  Lock at 0x5A14C38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51325==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==  Address 0x5a14c38 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14CE0 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14ce0 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14D38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51325==    by 0x1166A7: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:499)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14d38 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== Possible data race during write of size 8 at 0x5A14C70 by thread #3
==51325== Locks held: 2, at addresses 0x5A14C38 0x5A14CE0
==51325==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51325==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51325==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51325== 
==51325== This conflicts with a previous read of size 8 by thread #2
==51325== Locks held: 1, at address 0x5A14D38
==51325==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51325==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51325==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51325==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51325==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51325==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51325==    by 0x1166A7: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:499)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==  Address 0x5a14c70 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== ---Thread-Announcement------------------------------------------
==51325== 
==51325== Thread #4 was created
==51325==    at 0x4C3EA23: clone (clone.S:76)
==51325==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51325==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51325==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51325==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51325==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51325==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51325==    by 0x116609: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:493)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51325==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51325==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51325==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51325==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51325==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51325==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51325==    by 0x4C3EA33: clone (clone.S:100)
==51325== 
==51325== ---Thread-Announcement------------------------------------------
==51325== 
==51325== Thread #5 was created
==51325==    at 0x4C3EA23: clone (clone.S:76)
==51325==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51325==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51325==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51325==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51325==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51325==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51325==    by 0x116609: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:493)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51325==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51325==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51325==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51325==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51325==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51325==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51325==    by 0x4C3EA33: clone (clone.S:100)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325==  Lock at 0x5A14D38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51325==    by 0x1166A7: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:499)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14d38 is on thread #2's stack
==51325==  in frame #6, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14C38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51325==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==  Address 0x5a14c38 is on thread #2's stack
==51325==  in frame #6, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14CE0 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14ce0 is on thread #2's stack
==51325==  in frame #6, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== Possible data race during read of size 8 at 0x5A14C70 by thread #2
==51325== Locks held: 1, at address 0x5A14D38
==51325==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51325==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51325==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51325==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51325==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51325==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51325==    by 0x1166A7: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:499)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325== 
==51325== This conflicts with a previous write of size 8 by thread #3
==51325== Locks held: 2, at addresses 0x5A14C38 0x5A14CE0
==51325==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51325==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51325==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==  Address 0x5a14c70 is on thread #2's stack
==51325==  in frame #6, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325==  Lock at 0x5A14C38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51325==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==  Address 0x5a14c38 is on thread #2's stack
==51325==  in frame #4, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14CE0 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14ce0 is on thread #2's stack
==51325==  in frame #4, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== Possible data race during write of size 8 at 0x5A14C90 by thread #2
==51325== Locks held: 1, at address 0x5A14C38
==51325==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51325==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51325==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51325==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325== 
==51325== This conflicts with a previous read of size 8 by thread #3
==51325== Locks held: 1, at address 0x5A14CE0
==51325==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51325==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51325==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51325==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51325==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51325==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==  Address 0x5a14c90 is on thread #2's stack
==51325==  in frame #4, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325==  Lock at 0x5A14C38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51325==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51325==    by 0x11665B: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:495)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==  Address 0x5a14c38 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14CE0 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14ce0 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325==  Lock at 0x5A14D38 was first observed
==51325==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51325==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51325==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51325==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51325==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51325==    by 0x1166A7: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:499)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==  Address 0x5a14d38 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== Possible data race during write of size 8 at 0x5A14C70 by thread #3
==51325== Locks held: 2, at addresses 0x5A14C38 0x5A14CE0
==51325==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51325==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51325==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51325==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51325==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51325==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325== 
==51325== This conflicts with a previous read of size 8 by thread #2
==51325== Locks held: 1, at address 0x5A14D38
==51325==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51325==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51325==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51325==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51325==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51325==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51325==    by 0x1166A7: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:499)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==  Address 0x5a14c70 is on thread #2's stack
==51325==  in frame #5, created by test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:491)
==51325== 
==51325== ----------------------------------------------------------------
==51325== 
==51325== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51325==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51325==    by 0x1166F1: test_massive_schedule_wait_interleave()::{lambda()#1}::operator()() const (test_custom.cc:504)
==51325==    by 0x127D8A: void std::__invoke_impl<void, test_massive_schedule_wait_interleave()::{lambda()#1}>(std::__invoke_other, test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:61)
==51325==    by 0x127A98: std::__invoke_result<test_massive_schedule_wait_interleave()::{lambda()#1}>::type std::__invoke<test_massive_schedule_wait_interleave()::{lambda()#1}>(test_massive_schedule_wait_interleave()::{lambda()#1}&&) (invoke.h:96)
==51325==    by 0x1276DB: void std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51325==    by 0x1274DB: std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51325==    by 0x127383: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_massive_schedule_wait_interleave()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51325==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51325==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51325==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51325==    by 0x4C3EA33: clone (clone.S:100)
==51325== 
==51325== 
==51325== Use --history-level=approx or =none to gain increased speed, at
==51325== the cost of reduced accuracy of conflicting-access information
==51325== For lists of detected and suppressed errors, rerun with: -s
==51325== ERROR SUMMARY: 172 errors from 9 contexts (suppressed: 21771 from 37)
[1;31m❌ FAILED[0m
[34m[F10][0m Multiple schedule/wait rounds... ==51330== 
==51330== Use --history-level=approx or =none to gain increased speed, at
==51330== the cost of reduced accuracy of conflicting-access information
==51330== For lists of detected and suppressed errors, rerun with: -s
==51330== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
[1;32m✅ PASSED[0m
[34m[F11][0m Multiple wait() calls inside tasks... ==51331== 
==51331== Use --history-level=approx or =none to gain increased speed, at
==51331== the cost of reduced accuracy of conflicting-access information
==51331== For lists of detected and suppressed errors, rerun with: -s
==51331== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
[1;32m✅ PASSED[0m
[34m[F12][0m Concurrent schedule/wait in parallel... ==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #7 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x124CC0: std::thread::thread<test_concurrent_schedule_wait_parallel()::{lambda()#1}, , void>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (std_thread.h:164)
==51332==    by 0x11F01F: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (new_allocator.h:191)
==51332==    by 0x11F01F: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (alloc_traits.h:538)
==51332==    by 0x11F01F: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:468)
==51332==    by 0x11BF2A: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:123)
==51332==    by 0x1170BA: test_concurrent_schedule_wait_parallel() (test_custom.cc:603)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #2 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51332==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51332==    by 0x117060: test_concurrent_schedule_wait_parallel() (test_custom.cc:598)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #6, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEAF0 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51332==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51332==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==  Address 0x1ffeffeaf0 is on thread #1's stack
==51332==  in frame #6, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #7
==51332== Locks held: 1, at address 0x1FFEFFEA48
==51332==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51332==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51332==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332== 
==51332== This conflicts with a previous read of size 8 by thread #2
==51332== Locks held: 1, at address 0x1FFEFFEAF0
==51332==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51332==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51332==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51332==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51332==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51332==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==  Address 0x1ffeffeaa0 is on thread #1's stack
==51332==  in frame #6, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #7: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #8 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x124CC0: std::thread::thread<test_concurrent_schedule_wait_parallel()::{lambda()#1}, , void>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (std_thread.h:164)
==51332==    by 0x11F01F: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (new_allocator.h:191)
==51332==    by 0x11F01F: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (alloc_traits.h:538)
==51332==    by 0x11F01F: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:468)
==51332==    by 0x11BF2A: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:123)
==51332==    by 0x1170BA: test_concurrent_schedule_wait_parallel() (test_custom.cc:603)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #8: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #8
==51332== Locks held: 1, at address 0x1FFEFFEA48
==51332==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51332==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51332==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51332==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332== 
==51332== This conflicts with a previous write of size 8 by thread #7
==51332== Locks held: 1, at address 0x1FFEFFEA48
==51332==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51332==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51332==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==  Address 0x1ffeffeaa0 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #9 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x124CC0: std::thread::thread<test_concurrent_schedule_wait_parallel()::{lambda()#1}, , void>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (std_thread.h:164)
==51332==    by 0x11F01F: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (new_allocator.h:191)
==51332==    by 0x11F01F: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (alloc_traits.h:538)
==51332==    by 0x11F01F: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:468)
==51332==    by 0x11BF2A: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:123)
==51332==    by 0x1170BA: test_concurrent_schedule_wait_parallel() (test_custom.cc:603)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #9: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51332==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEAF0 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51332==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51332==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==  Address 0x1ffeffeaf0 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during read of size 8 at 0x1FFEFFEAA0 by thread #2
==51332== Locks held: 1, at address 0x1FFEFFEAF0
==51332==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51332==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51332==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51332==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51332==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51332==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332== 
==51332== This conflicts with a previous write of size 8 by thread #9
==51332== Locks held: 1, at address 0x1FFEFFEA48
==51332==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51332==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51332==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==  Address 0x1ffeffeaa0 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #10 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x124CC0: std::thread::thread<test_concurrent_schedule_wait_parallel()::{lambda()#1}, , void>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (std_thread.h:164)
==51332==    by 0x11BEC0: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (new_allocator.h:191)
==51332==    by 0x11BEC0: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (alloc_traits.h:538)
==51332==    by 0x11BEC0: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (vector.tcc:117)
==51332==    by 0x1170BA: test_concurrent_schedule_wait_parallel() (test_custom.cc:603)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #10: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51332==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #11 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x124DC0: std::thread::thread<test_concurrent_schedule_wait_parallel()::{lambda()#2}, , void>(test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (std_thread.h:164)
==51332==    by 0x11F503: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (new_allocator.h:191)
==51332==    by 0x11F503: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (alloc_traits.h:538)
==51332==    by 0x11F503: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_concurrent_schedule_wait_parallel()::{lambda()#2}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (vector.tcc:468)
==51332==    by 0x11C04C: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_concurrent_schedule_wait_parallel()::{lambda()#2}>(test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (vector.tcc:123)
==51332==    by 0x11710C: test_concurrent_schedule_wait_parallel() (test_custom.cc:615)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEB48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffeb48 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during read of size 8 at 0x1FFEFFEAA0 by thread #11
==51332== Locks held: 1, at address 0x1FFEFFEB48
==51332==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51332==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51332==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51332==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51332==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51332==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51332==    by 0x117002: test_concurrent_schedule_wait_parallel()::{lambda()#2}::operator()() const (test_custom.cc:616)
==51332==    by 0x127B28: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#2}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (invoke.h:61)
==51332==    by 0x12775A: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#2}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#2}>(test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (invoke.h:96)
==51332==    by 0x127523: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273C3: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#2}> >::operator()() (std_thread.h:299)
==51332==    by 0x12721B: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51332== 
==51332== This conflicts with a previous write of size 8 by thread #10
==51332== Locks held: 1, at address 0x1FFEFFEA48
==51332==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51332==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51332==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==  Address 0x1ffeffeaa0 is on thread #1's stack
==51332==  in frame #8, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #3 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51332==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51332==    by 0x117060: test_concurrent_schedule_wait_parallel() (test_custom.cc:598)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51332==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51332==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51332==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51332==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51332==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #7: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51332==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #1 is the program's root thread
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEAF0 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51332==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51332==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==  Address 0x1ffeffeaf0 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEB48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffeb48 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51332== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51332==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51332==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51332==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332== 
==51332== This conflicts with a previous read of size 8 by thread #1
==51332== Locks held: 1, at address 0x1FFEFFEB48
==51332==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51332==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51332==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51332==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51332==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51332==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51332==    by 0x1171C4: test_concurrent_schedule_wait_parallel() (test_custom.cc:623)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==  Address 0x1ffeffea80 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #4 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51332==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51332==    by 0x117060: test_concurrent_schedule_wait_parallel() (test_custom.cc:598)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51332==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51332==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51332==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51332==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51332==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #12 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x124DC0: std::thread::thread<test_concurrent_schedule_wait_parallel()::{lambda()#2}, , void>(test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (std_thread.h:164)
==51332==    by 0x11F503: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (new_allocator.h:191)
==51332==    by 0x11F503: construct<std::thread, test_concurrent_schedule_wait_parallel()::<lambda()> > (alloc_traits.h:538)
==51332==    by 0x11F503: void std::vector<std::thread, std::allocator<std::thread> >::_M_realloc_insert<test_concurrent_schedule_wait_parallel()::{lambda()#2}>(__gnu_cxx::__normal_iterator<std::thread*, std::vector<std::thread, std::allocator<std::thread> > >, test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (vector.tcc:468)
==51332==    by 0x11C04C: void std::vector<std::thread, std::allocator<std::thread> >::emplace_back<test_concurrent_schedule_wait_parallel()::{lambda()#2}>(test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (vector.tcc:123)
==51332==    by 0x11710C: test_concurrent_schedule_wait_parallel() (test_custom.cc:615)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEB48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffeb48 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEAF0 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51332==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51332==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==  Address 0x1ffeffeaf0 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #12
==51332== Locks held: 1, at address 0x1FFEFFEB48
==51332==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51332==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51332==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51332==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51332==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51332==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51332==    by 0x117002: test_concurrent_schedule_wait_parallel()::{lambda()#2}::operator()() const (test_custom.cc:616)
==51332==    by 0x127B28: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#2}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (invoke.h:61)
==51332==    by 0x12775A: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#2}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#2}>(test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (invoke.h:96)
==51332==    by 0x127523: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273C3: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#2}> >::operator()() (std_thread.h:299)
==51332==    by 0x12721B: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51332== 
==51332== This conflicts with a previous write of size 8 by thread #2
==51332== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51332==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51332==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51332==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==  Address 0x1ffeffea80 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #5 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51332==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51332==    by 0x117060: test_concurrent_schedule_wait_parallel() (test_custom.cc:598)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51332==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51332==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51332==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51332==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51332==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ---Thread-Announcement------------------------------------------
==51332== 
==51332== Thread #6 was created
==51332==    at 0x4C3EA23: clone (clone.S:76)
==51332==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51332==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51332==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51332==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51332==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51332==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51332==    by 0x117060: test_concurrent_schedule_wait_parallel() (test_custom.cc:598)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51332==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51332==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51332==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51332==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51332==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51332==    by 0x4C3EA33: clone (clone.S:100)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332==  Lock at 0x1FFEFFEA48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51332==    by 0x116F83: test_concurrent_schedule_wait_parallel()::{lambda()#1}::operator()() const (test_custom.cc:605)
==51332==    by 0x127B65: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#1}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x1277AD: std::__invoke_result<test_concurrent_schedule_wait_parallel()::{lambda()#1}>::type std::__invoke<test_concurrent_schedule_wait_parallel()::{lambda()#1}>(test_concurrent_schedule_wait_parallel()::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x12754F: void std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x1273DF: std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x12723F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_concurrent_schedule_wait_parallel()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffea48 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEAF0 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51332==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51332==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==  Address 0x1ffeffeaf0 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332==  Lock at 0x1FFEFFEB48 was first observed
==51332==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51332==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51332==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51332==    by 0x10E2CC: ThreadPool::dispatcher() (thread-pool.cc:66)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==  Address 0x1ffeffeb48 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51332== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51332==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51332==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51332==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51332==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51332==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51332==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51332==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51332==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51332==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51332==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51332==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51332==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332== 
==51332== This conflicts with a previous read of size 8 by thread #11
==51332== Locks held: 1, at address 0x1FFEFFEB48
==51332==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51332==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51332==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51332==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51332==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51332==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51332==    by 0x117002: test_concurrent_schedule_wait_parallel()::{lambda()#2}::operator()() const (test_custom.cc:616)
==51332==    by 0x127B28: void std::__invoke_impl<void, test_concurrent_schedule_wait_parallel()::{lambda()#2}>(std::__invoke_other, test_concurrent_schedule_wait_parallel()::{lambda()#2}&&) (invoke.h:61)
==51332==  Address 0x1ffeffea80 is on thread #1's stack
==51332==  in frame #5, created by test_concurrent_schedule_wait_parallel() (test_custom.cc:591)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x4BB0756: __pthread_cond_wait_common (pthread_cond_wait.c:599)
==51332==    by 0x4BB0756: pthread_cond_wait@@GLIBC_2.3.2 (pthread_cond_wait.c:627)
==51332==    by 0x4854D21: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10EC74: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:105)
==51332==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51332==    by 0x1171C4: test_concurrent_schedule_wait_parallel() (test_custom.cc:623)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51332==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51332==    by 0x11A0DF: main (test_custom.cc:951)
==51332== 
==51332== ----------------------------------------------------------------
==51332== 
==51332== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51332==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51332==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51332==    by 0x117306: test_concurrent_schedule_wait_parallel() (test_custom.cc:630)
==51332==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51332==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51332==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51332==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51332==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51332==    by 0x11A0DF: main (test_custom.cc:951)
==51332== 
==51332== 
==51332== Use --history-level=approx or =none to gain increased speed, at
==51332== the cost of reduced accuracy of conflicting-access information
==51332== For lists of detected and suppressed errors, rerun with: -s
==51332== ERROR SUMMARY: 640 errors from 18 contexts (suppressed: 88645 from 41)
[1;31m❌ FAILED[0m
[31m[H01][0m Wait inside task should deadlock... ==51344== 
==51344== Use --history-level=approx or =none to gain increased speed, at
==51344== the cost of reduced accuracy of conflicting-access information
==51344== For lists of detected and suppressed errors, rerun with: -s
==51344== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
[1;32m✅ PASSED[0m
[33m[L01][0m Destructor waits for tasks completion... ==51345== ---Thread-Announcement------------------------------------------
==51345== 
==51345== Thread #1 is the program's root thread
==51345== 
==51345== ---Thread-Announcement------------------------------------------
==51345== 
==51345== Thread #2 was created
==51345==    at 0x4C3EA23: clone (clone.S:76)
==51345==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51345==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51345==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51345==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51345==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51345==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51345==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51345==    by 0x1173D7: test_destructor_waits_for_tasks() (test_custom.cc:642)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345== 
==51345== ----------------------------------------------------------------
==51345== 
==51345==  Lock at 0x1FFEFFEA48 was first observed
==51345==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51345==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51345==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51345==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51345==    by 0x117409: test_destructor_waits_for_tasks() (test_custom.cc:643)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51345==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51345==    by 0x11A0DF: main (test_custom.cc:951)
==51345==  Address 0x1ffeffea48 is on thread #1's stack
==51345==  in frame #3, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345==  Lock at 0x1FFEFFEAF0 was first observed
==51345==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51345==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51345==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51345==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51345==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51345==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51345==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51345==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51345==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51345==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51345==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51345==  Address 0x1ffeffeaf0 is on thread #1's stack
==51345==  in frame #3, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51345== Locks held: 1, at address 0x1FFEFFEA48
==51345==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51345==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51345==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51345==    by 0x117409: test_destructor_waits_for_tasks() (test_custom.cc:643)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51345==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51345==    by 0x11A0DF: main (test_custom.cc:951)
==51345== 
==51345== This conflicts with a previous read of size 8 by thread #2
==51345== Locks held: 1, at address 0x1FFEFFEAF0
==51345==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51345==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51345==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51345==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51345==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51345==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51345==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51345==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51345==  Address 0x1ffeffeaa0 is on thread #1's stack
==51345==  in frame #3, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345== ----------------------------------------------------------------
==51345== 
==51345== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51345==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51345==    by 0x117409: test_destructor_waits_for_tasks() (test_custom.cc:643)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51345==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51345==    by 0x11A0DF: main (test_custom.cc:951)
==51345== 
==51345== ----------------------------------------------------------------
==51345== 
==51345==  Lock at 0x1FFEFFEA48 was first observed
==51345==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51345==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51345==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51345==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51345==    by 0x117409: test_destructor_waits_for_tasks() (test_custom.cc:643)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51345==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51345==    by 0x11A0DF: main (test_custom.cc:951)
==51345==  Address 0x1ffeffea48 is on thread #1's stack
==51345==  in frame #6, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345==  Lock at 0x1FFEFFEAF0 was first observed
==51345==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51345==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51345==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51345==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51345==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51345==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51345==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51345==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51345==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51345==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51345==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51345==  Address 0x1ffeffeaf0 is on thread #1's stack
==51345==  in frame #6, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345==  Lock at 0x1FFEFFEB48 was first observed
==51345==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51345==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51345==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51345==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51345==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51345==    by 0x10E852: ThreadPool::~ThreadPool() (thread-pool.cc:123)
==51345==    by 0x117427: test_destructor_waits_for_tasks() (test_custom.cc:646)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51345==  Address 0x1ffeffeb48 is on thread #1's stack
==51345==  in frame #6, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51345== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51345==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51345==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51345==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51345==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51345==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51345==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51345==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51345==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51345==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51345==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51345==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51345== 
==51345== This conflicts with a previous read of size 8 by thread #1
==51345== Locks held: 1, at address 0x1FFEFFEB48
==51345==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51345==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51345==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51345==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51345==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51345==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51345==    by 0x10E852: ThreadPool::~ThreadPool() (thread-pool.cc:123)
==51345==    by 0x117427: test_destructor_waits_for_tasks() (test_custom.cc:646)
==51345==  Address 0x1ffeffea80 is on thread #1's stack
==51345==  in frame #6, created by test_destructor_waits_for_tasks() (test_custom.cc:639)
==51345== 
==51345== ---Thread-Announcement------------------------------------------
==51345== 
==51345== Thread #3 was created
==51345==    at 0x4C3EA23: clone (clone.S:76)
==51345==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51345==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51345==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51345==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51345==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51345==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51345==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51345==    by 0x1173D7: test_destructor_waits_for_tasks() (test_custom.cc:642)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345== 
==51345== ----------------------------------------------------------------
==51345== 
==51345== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51345==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51345==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51345==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51345==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51345==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51345==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51345==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51345==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51345==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51345==    by 0x4C3EA33: clone (clone.S:100)
==51345== 
==51345== ----------------------------------------------------------------
==51345== 
==51345== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51345==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51345==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51345==    by 0x117427: test_destructor_waits_for_tasks() (test_custom.cc:646)
==51345==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51345==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51345==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51345==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51345==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51345==    by 0x11A0DF: main (test_custom.cc:951)
==51345== 
==51345== 
==51345== Use --history-level=approx or =none to gain increased speed, at
==51345== the cost of reduced accuracy of conflicting-access information
==51345== For lists of detected and suppressed errors, rerun with: -s
==51345== ERROR SUMMARY: 5 errors from 5 contexts (suppressed: 79 from 21)
[1;31m❌ FAILED[0m
[33m[L02][0m Repeated pool creation and destruction... ==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #1 is the program's root thread
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #2 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51348==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348==  Lock at 0x1FFEFFEA48 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51348==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51348==    by 0x1175BE: test_repeated_pool_creation() (test_custom.cc:659)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==    by 0x11A0DF: main (test_custom.cc:951)
==51348==  Address 0x1ffeffea48 is on thread #1's stack
==51348==  in frame #3, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348==  Lock at 0x1FFEFFEAF0 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51348==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51348==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51348==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51348==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51348==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51348==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51348==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51348==  Address 0x1ffeffeaf0 is on thread #1's stack
==51348==  in frame #3, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51348== Locks held: 1, at address 0x1FFEFFEA48
==51348==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51348==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51348==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51348==    by 0x1175BE: test_repeated_pool_creation() (test_custom.cc:659)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==    by 0x11A0DF: main (test_custom.cc:951)
==51348== 
==51348== This conflicts with a previous read of size 8 by thread #2
==51348== Locks held: 1, at address 0x1FFEFFEAF0
==51348==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51348==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51348==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51348==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51348==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51348==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51348==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51348==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51348==  Address 0x1ffeffeaa0 is on thread #1's stack
==51348==  in frame #3, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51348==    by 0x1175BE: test_repeated_pool_creation() (test_custom.cc:659)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==    by 0x11A0DF: main (test_custom.cc:951)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348==  Lock at 0x1FFEFFEA48 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51348==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51348==    by 0x1175BE: test_repeated_pool_creation() (test_custom.cc:659)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==    by 0x11A0DF: main (test_custom.cc:951)
==51348==  Address 0x1ffeffea48 is on thread #1's stack
==51348==  in frame #5, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348==  Lock at 0x1FFEFFEAF0 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51348==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51348==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51348==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51348==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51348==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51348==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51348==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51348==  Address 0x1ffeffeaf0 is on thread #1's stack
==51348==  in frame #5, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348==  Lock at 0x1FFEFFEB48 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51348==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51348==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51348==    by 0x1175EC: test_repeated_pool_creation() (test_custom.cc:663)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==  Address 0x1ffeffeb48 is on thread #1's stack
==51348==  in frame #5, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51348== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51348==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51348==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51348==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51348==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51348==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51348==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51348==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51348==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348== 
==51348== This conflicts with a previous read of size 8 by thread #1
==51348== Locks held: 1, at address 0x1FFEFFEB48
==51348==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51348==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51348==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51348==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51348==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51348==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51348==    by 0x1175EC: test_repeated_pool_creation() (test_custom.cc:663)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==  Address 0x1ffeffea80 is on thread #1's stack
==51348==  in frame #5, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #3 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #4 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348==  Lock at 0x1FFEFFEB48 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51348==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51348==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51348==    by 0x1175EC: test_repeated_pool_creation() (test_custom.cc:663)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==  Address 0x1ffeffeb48 is on thread #1's stack
==51348==  in frame #6, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348==  Lock at 0x1FFEFFEA48 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51348==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51348==    by 0x1175BE: test_repeated_pool_creation() (test_custom.cc:659)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==    by 0x11A0DF: main (test_custom.cc:951)
==51348==  Address 0x1ffeffea48 is on thread #1's stack
==51348==  in frame #6, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348==  Lock at 0x1FFEFFEAF0 was first observed
==51348==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51348==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51348==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51348==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51348==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51348==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51348==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51348==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51348==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51348==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51348==  Address 0x1ffeffeaf0 is on thread #1's stack
==51348==  in frame #6, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348== Possible data race during read of size 8 at 0x1FFEFFEA80 by thread #1
==51348== Locks held: 1, at address 0x1FFEFFEB48
==51348==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51348==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51348==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51348==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51348==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51348==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51348==    by 0x1175EC: test_repeated_pool_creation() (test_custom.cc:663)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348== 
==51348== This conflicts with a previous write of size 8 by thread #2
==51348== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51348==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51348==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51348==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51348==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51348==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51348==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51348==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51348==  Address 0x1ffeffea80 is on thread #1's stack
==51348==  in frame #6, created by test_repeated_pool_creation() (test_custom.cc:652)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51348==    by 0x117626: test_repeated_pool_creation() (test_custom.cc:665)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51348==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51348==    by 0x11A0DF: main (test_custom.cc:951)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #7 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #7: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #6 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #9 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #9: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #10 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #10: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #12 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #12: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #13 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #13: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #15 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #15: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #16 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #16: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #18 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #18: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #19 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #19: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #21 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #21: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #22 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #22: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #24 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #24: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #25 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #25: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #27 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #27: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #28 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #28: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #30 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #30: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #31 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #31: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #33 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #33: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #34 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #34: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #36 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #36: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #37 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #37: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #39 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #39: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #40 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #40: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #42 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #42: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #43 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #43: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #45 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #45: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #46 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #46: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #48 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #48: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #49 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #49: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #52 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #52: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #51 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #51: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #54 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #54: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #55 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #55: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #57 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #57: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #58 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #58: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #60 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #60: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #61 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #61: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #63 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #63: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #64 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #64: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #66 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #66: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #67 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #67: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #69 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #69: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #70 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #70: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #72 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #72: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #73 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #73: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #75 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #75: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #76 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #76: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #79 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #79: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #78 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #78: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #81 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #81: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #82 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #82: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #84 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #84: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #85 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #85: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #87 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #87: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #88 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #88: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #90 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #90: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #91 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #91: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #93 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #93: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #94 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #94: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #96 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #96: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #97 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #97: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #99 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #99: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #100 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #100: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #102 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #102: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #103 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #103: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #105 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #105: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #106 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #106: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #108 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #108: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #109 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #109: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #111 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #111: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #112 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #112: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #114 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #114: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #115 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #115: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #117 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #117: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #118 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #118: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #120 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #120: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #121 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #121: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #124 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #124: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #123 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #123: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #126 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #126: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #127 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #127: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #129 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #129: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #130 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #130: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #132 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #132: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #133 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #133: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #135 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #135: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #136 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #136: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #138 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #138: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #139 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #139: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #141 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #141: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #142 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #142: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #144 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #144: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== 
==51348== More than 100 errors detected.  Subsequent errors
==51348== will still be recorded, but in less detail than before.
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #145 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #145: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #147 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #147: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #148 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #148: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #150 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #150: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #151 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #151: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #153 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #153: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #154 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #154: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #157 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #157: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #156 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #156: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #159 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #159: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #160 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #160: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #162 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #162: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #163 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #163: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #165 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #165: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #166 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #166: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #168 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #168: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #169 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #169: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #171 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #171: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #172 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #172: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #174 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #174: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #175 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #175: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #177 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #177: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #178 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #178: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #180 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #180: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #181 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #181: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #184 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #184: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #183 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #183: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #186 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #186: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #187 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #187: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #189 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #189: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #190 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #190: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #193 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #193: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #192 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #192: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #195 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #195: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #196 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #196: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #198 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #198: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #199 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #199: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #201 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #201: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #202 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #202: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #205 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #205: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #204 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #204: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #207 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #207: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #208 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #208: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #211 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #211: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #210 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #210: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #213 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #213: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #214 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #214: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #217 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #217: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #216 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #216: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #219 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #219: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #220 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #220: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #222 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #222: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #223 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #223: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #226 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #226: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #225 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #225: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #228 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #228: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #229 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #229: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #231 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #231: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #232 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #232: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #234 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #234: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #235 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #235: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #238 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #238: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #237 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #237: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #241 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #241: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #240 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #240: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #243 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #243: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #244 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #244: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #246 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #246: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #247 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #247: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #249 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #249: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #250 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #250: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #252 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #252: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #253 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #253: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #255 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #255: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #256 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #256: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #259 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #259: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #258 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #258: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #261 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #261: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #262 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #262: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #265 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #265: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #264 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #264: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #267 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #267: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #268 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #268: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #271 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #271: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #270 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #270: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #273 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #273: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #274 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #274: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #276 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #276: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #277 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #277: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #279 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #279: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #280 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #280: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #282 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #282: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #283 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #283: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #286 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #286: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #285 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #285: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #288 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #288: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #289 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #289: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #291 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #291: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #292 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #292: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #294 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #294: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #295 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #295: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #297 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #297: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #298 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #298: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #301 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #301: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== ---Thread-Announcement------------------------------------------
==51348== 
==51348== Thread #300 was created
==51348==    at 0x4C3EA23: clone (clone.S:76)
==51348==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51348==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51348==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51348==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51348==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51348==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51348==    by 0x117568: test_repeated_pool_creation() (test_custom.cc:656)
==51348==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51348==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51348==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51348== 
==51348== ----------------------------------------------------------------
==51348== 
==51348== Thread #300: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51348==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51348==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51348==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51348==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51348==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51348==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51348==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51348==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51348==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51348==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51348==    by 0x4C3EA33: clone (clone.S:100)
==51348== 
==51348== 
==51348== Use --history-level=approx or =none to gain increased speed, at
==51348== the cost of reduced accuracy of conflicting-access information
==51348== For lists of detected and suppressed errors, rerun with: -s
==51348== ERROR SUMMARY: 3570 errors from 205 contexts (suppressed: 58634 from 32)
[1;31m❌ FAILED[0m
[91m[M01][0m Schedule nullptr function... ==51649== ---Thread-Announcement------------------------------------------
==51649== 
==51649== Thread #1 is the program's root thread
==51649== 
==51649== ----------------------------------------------------------------
==51649== 
==51649== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51649==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51649==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51649==    by 0x118511: test_schedule_nullptr() (test_custom.cc:808)
==51649==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51649==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51649==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51649==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51649==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51649==    by 0x11A0DF: main (test_custom.cc:951)
==51649== 
==51649== 
==51649== Use --history-level=approx or =none to gain increased speed, at
==51649== the cost of reduced accuracy of conflicting-access information
==51649== For lists of detected and suppressed errors, rerun with: -s
==51649== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 53 from 16)
[1;31m❌ FAILED[0m
[91m[M02][0m wait() during infinite rescheduling... ==51653== 
==51653== Use --history-level=approx or =none to gain increased speed, at
==51653== the cost of reduced accuracy of conflicting-access information
==51653== For lists of detected and suppressed errors, rerun with: -s
==51653== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
[1;32m✅ PASSED[0m
[96m[N01][0m Deep nested task scheduling... ==51654== ---Thread-Announcement------------------------------------------
==51654== 
==51654== Thread #2 was created
==51654==    at 0x4C3EA23: clone (clone.S:76)
==51654==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51654==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51654==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51654==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51654==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x11C38C: std::thread::thread<test_deep_nested_scheduling()::{lambda()#1}, , void>(test_deep_nested_scheduling()::{lambda()#1}&&) (std_thread.h:164)
==51654==    by 0x117A62: test_deep_nested_scheduling() (test_custom.cc:698)
==51654==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51654==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51654==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51654==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51654== 
==51654== ---Thread-Announcement------------------------------------------
==51654== 
==51654== Thread #3 was created
==51654==    at 0x4C3EA23: clone (clone.S:76)
==51654==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51654==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51654==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51654==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51654==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51654==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51654==    by 0x11789D: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:682)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654==  Lock at 0x5A14C38 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51654==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51654==    by 0x1178F5: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:684)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==  Address 0x5a14c38 is on thread #2's stack
==51654==  in frame #3, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654==  Lock at 0x5A14CE0 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51654==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51654==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==  Address 0x5a14ce0 is on thread #2's stack
==51654==  in frame #3, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== Possible data race during write of size 8 at 0x5A14C90 by thread #2
==51654== Locks held: 1, at address 0x5A14C38
==51654==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51654==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51654==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51654==    by 0x1178F5: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:684)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51654== 
==51654== This conflicts with a previous read of size 8 by thread #3
==51654== Locks held: 1, at address 0x5A14CE0
==51654==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51654==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51654==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51654==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51654==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51654==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==  Address 0x5a14c90 is on thread #2's stack
==51654==  in frame #3, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51654==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51654==    by 0x1178F5: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:684)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51654==    by 0x4C3EA33: clone (clone.S:100)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654==  Lock at 0x5A14C38 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51654==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51654==    by 0x1178F5: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:684)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==  Address 0x5a14c38 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654==  Lock at 0x5A14CE0 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51654==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51654==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==  Address 0x5a14ce0 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654==  Lock at 0x5A14D38 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51654==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51654==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51654==    by 0x117913: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:693)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==  Address 0x5a14d38 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== Possible data race during write of size 8 at 0x5A14C70 by thread #3
==51654== Locks held: 2, at addresses 0x5A14C38 0x5A14CE0
==51654==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51654==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51654==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51654== 
==51654== This conflicts with a previous read of size 8 by thread #2
==51654== Locks held: 1, at address 0x5A14D38
==51654==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51654==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51654==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51654==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51654==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51654==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51654==    by 0x117913: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:693)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==  Address 0x5a14c70 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== ---Thread-Announcement------------------------------------------
==51654== 
==51654== Thread #4 was created
==51654==    at 0x4C3EA23: clone (clone.S:76)
==51654==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51654==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51654==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51654==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51654==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51654==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51654==    by 0x11789D: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:682)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654==  Lock at 0x5A14C38 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51654==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51654==    by 0x1178F5: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:684)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==  Address 0x5a14c38 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654==  Lock at 0x5A14CE0 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51654==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51654==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==  Address 0x5a14ce0 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== Possible data race during write of size 8 at 0x5A14C90 by thread #4
==51654== Locks held: 1, at address 0x5A14C38
==51654==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51654==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51654==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51654==    by 0x11780C: test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const (test_custom.cc:686)
==51654==    by 0x125125: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:61)
==51654==    by 0x122DAA: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&>(test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:150)
==51654==    by 0x11FC90: std::_Function_handler<void (), test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51654==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51654==    by 0x10E5B4: ThreadPool::worker(int) (thread-pool.cc:95)
==51654==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51654==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51654==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51654== 
==51654== This conflicts with a previous read of size 8 by thread #3
==51654== Locks held: 1, at address 0x5A14CE0
==51654==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51654==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51654==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51654==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51654==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51654==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==  Address 0x5a14c90 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51654==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51654==    by 0x11780C: test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const (test_custom.cc:686)
==51654==    by 0x125125: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:61)
==51654==    by 0x122DAA: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&>(test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:150)
==51654==    by 0x11FC90: std::_Function_handler<void (), test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51654==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51654==    by 0x10E5B4: ThreadPool::worker(int) (thread-pool.cc:95)
==51654==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51654==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51654==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51654==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51654==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51654==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51654==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51654==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51654==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51654==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51654==    by 0x4C3EA33: clone (clone.S:100)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654==  Lock at 0x5A14C38 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51654==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51654==    by 0x1178F5: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:684)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==  Address 0x5a14c38 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654==  Lock at 0x5A14CE0 was first observed
==51654==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51654==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51654==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51654==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51654==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==  Address 0x5a14ce0 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== Possible data race during write of size 8 at 0x5A14C90 by thread #4
==51654== Locks held: 1, at address 0x5A14C38
==51654==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51654==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51654==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51654==    by 0x117740: test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const (test_custom.cc:688)
==51654==    by 0x12507F: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:61)
==51654==    by 0x122C4A: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&>(test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:150)
==51654==    by 0x11FB9C: std::_Function_handler<void (), test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51654==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51654==    by 0x10E5B4: ThreadPool::worker(int) (thread-pool.cc:95)
==51654==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51654==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51654==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51654== 
==51654== This conflicts with a previous read of size 8 by thread #3
==51654== Locks held: 1, at address 0x5A14CE0
==51654==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51654==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51654==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51654==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51654==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51654==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51654==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51654==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51654==  Address 0x5a14c90 is on thread #2's stack
==51654==  in frame #5, created by test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:680)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51654==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51654==    by 0x117740: test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const (test_custom.cc:688)
==51654==    by 0x12507F: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:61)
==51654==    by 0x122C4A: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&>(test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}&) (invoke.h:150)
==51654==    by 0x11FB9C: std::_Function_handler<void (), test_deep_nested_scheduling()::{lambda()#1}::operator()() const::{lambda()#1}::operator()() const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51654==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51654==    by 0x10E5B4: ThreadPool::worker(int) (thread-pool.cc:95)
==51654==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51654==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51654==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51654==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654== 
==51654== ----------------------------------------------------------------
==51654== 
==51654== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51654==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51654==    by 0x117959: test_deep_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:695)
==51654==    by 0x127CD3: void std::__invoke_impl<void, test_deep_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51654==    by 0x12799F: std::__invoke_result<test_deep_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_deep_nested_scheduling()::{lambda()#1}>(test_deep_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51654==    by 0x127657: void std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51654==    by 0x127487: std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51654==    by 0x127317: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_deep_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51654==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51654==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51654==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51654==    by 0x4C3EA33: clone (clone.S:100)
==51654== 
==51654== 
==51654== Use --history-level=approx or =none to gain increased speed, at
==51654== the cost of reduced accuracy of conflicting-access information
==51654== For lists of detected and suppressed errors, rerun with: -s
==51654== ERROR SUMMARY: 12 errors from 9 contexts (suppressed: 259 from 34)
[1;31m❌ FAILED[0m
[96m[N02][0m Extreme nested scheduling (1000)... ==51661== ---Thread-Announcement------------------------------------------
==51661== 
==51661== Thread #2 was created
==51661==    at 0x4C3EA23: clone (clone.S:76)
==51661==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51661==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51661==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51661==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51661==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x11C5C0: std::thread::thread<test_extreme_nested_scheduling()::{lambda()#1}, , void>(test_extreme_nested_scheduling()::{lambda()#1}&&) (std_thread.h:164)
==51661==    by 0x117EC3: test_extreme_nested_scheduling() (test_custom.cc:736)
==51661==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51661==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51661==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51661==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51661== 
==51661== ---Thread-Announcement------------------------------------------
==51661== 
==51661== Thread #3 was created
==51661==    at 0x4C3EA23: clone (clone.S:76)
==51661==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51661==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51661==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51661==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51661==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51661==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51661==    by 0x117C5D: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:713)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661==  Lock at 0x5A14C38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51661==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c38 is on thread #2's stack
==51661==  in frame #8, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14CE0 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14ce0 is on thread #2's stack
==51661==  in frame #8, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== Possible data race during write of size 8 at 0x5A14C90 by thread #2
==51661== Locks held: 1, at address 0x5A14C38
==51661==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51661==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51661==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661== 
==51661== This conflicts with a previous read of size 8 by thread #3
==51661== Locks held: 1, at address 0x5A14CE0
==51661==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51661==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51661==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51661==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51661==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51661==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c90 is on thread #2's stack
==51661==  in frame #8, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51661==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x12746B: std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661==  Lock at 0x5A14C38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51661==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c38 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14CE0 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14ce0 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14D38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51661==    by 0x117CD9: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:728)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x12746B: std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x1272F3: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14d38 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== Possible data race during write of size 8 at 0x5A14C70 by thread #3
==51661== Locks held: 2, at addresses 0x5A14C38 0x5A14CE0
==51661==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51661==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51661==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51661== 
==51661== This conflicts with a previous read of size 8 by thread #2
==51661== Locks held: 1, at address 0x5A14D38
==51661==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51661==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51661==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51661==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51661==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51661==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51661==    by 0x117CD9: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:728)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c70 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== ---Thread-Announcement------------------------------------------
==51661== 
==51661== Thread #4 was created
==51661==    at 0x4C3EA23: clone (clone.S:76)
==51661==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51661==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51661==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51661==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51661==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51661==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51661==    by 0x117C5D: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:713)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51661==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117B42: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}::operator()() const (test_custom.cc:722)
==51661==    by 0x1251FF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:61)
==51661==    by 0x122F3D: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:150)
==51661==    by 0x11FE03: std::_Function_handler<void (), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51661==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51661==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51661==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51661==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51661==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51661==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51661==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51661==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51661==    by 0x4C3EA33: clone (clone.S:100)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661==  Lock at 0x5A14D38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51661==    by 0x117CD9: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:728)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x12746B: std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x1272F3: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14d38 is on thread #2's stack
==51661==  in frame #6, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14C38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51661==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c38 is on thread #2's stack
==51661==  in frame #6, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== Possible data race during read of size 8 at 0x5A14C90 by thread #2
==51661== Locks held: 1, at address 0x5A14D38
==51661==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51661==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51661==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51661==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51661==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51661==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51661==    by 0x117CD9: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:728)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x12746B: std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x1272F3: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661== 
==51661== This conflicts with a previous write of size 8 by thread #4
==51661== Locks held: 1, at address 0x5A14C38
==51661==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51661==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51661==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==  Address 0x5a14c90 is on thread #2's stack
==51661==  in frame #6, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== ---Thread-Announcement------------------------------------------
==51661== 
==51661== Thread #5 was created
==51661==    at 0x4C3EA23: clone (clone.S:76)
==51661==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51661==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51661==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51661==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51661==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51661==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51661==    by 0x117C5D: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:713)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51661==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117B42: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}::operator()() const (test_custom.cc:722)
==51661==    by 0x1251FF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:61)
==51661==    by 0x122F3D: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:150)
==51661==    by 0x11FE03: std::_Function_handler<void (), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51661==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51661==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51661==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51661==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51661==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51661==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51661==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51661==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51661==    by 0x4C3EA33: clone (clone.S:100)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661==  Lock at 0x5A14C38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51661==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c38 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14CE0 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14ce0 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== Possible data race during write of size 8 at 0x5A14C90 by thread #4
==51661== Locks held: 1, at address 0x5A14C38
==51661==    at 0x1113BD: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:509)
==51661==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51661==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51661==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117B42: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}::operator()() const (test_custom.cc:722)
==51661==    by 0x1251FF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:61)
==51661==    by 0x122F3D: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:150)
==51661== 
==51661== This conflicts with a previous read of size 8 by thread #3
==51661== Locks held: 1, at address 0x5A14CE0
==51661==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51661==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51661==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51661==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51661==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51661==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c90 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661==  Lock at 0x5A14C38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51661==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c38 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14CE0 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14ce0 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== Possible data race during write of size 8 at 0x5A14C70 by thread #3
==51661== Locks held: 2, at addresses 0x5A14C38 0x5A14CE0
==51661==    at 0x111677: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_pop_front_aux() (deque.tcc:583)
==51661==    by 0x110ABD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1585)
==51661==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51661==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661== 
==51661== This conflicts with a previous read of size 8 by thread #4
==51661== Locks held: 1, at address 0x5A14C38
==51661==    at 0x111FA3: std::operator-(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:375)
==51661==    by 0x111B80: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::size() const (stl_deque.h:1269)
==51661==    by 0x1112C6: void std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::_M_push_back_aux<std::function<void ()> const&>(std::function<void ()> const&) (deque.tcc:492)
==51661==    by 0x1107DD: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1548)
==51661==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51661==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==  Address 0x5a14c70 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661==  Lock at 0x5A14CE0 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51661==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51661==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==  Address 0x5a14ce0 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661==  Lock at 0x5A14C38 was first observed
==51661==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51661==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51661==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51661==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117CCA: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:727)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==  Address 0x5a14c38 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== Possible data race during read of size 8 at 0x5A14C90 by thread #3
==51661== Locks held: 1, at address 0x5A14CE0
==51661==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51661==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51661==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51661==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51661==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51661==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51661==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51661==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661== 
==51661== This conflicts with a previous write of size 8 by thread #4
==51661== Locks held: 1, at address 0x5A14C38
==51661==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51661==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51661==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==  Address 0x5a14c90 is on thread #2's stack
==51661==  in frame #5, created by test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:711)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #4: pthread_cond_{signal,broadcast}: associated lock is not held by calling thread
==51661==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51661==    by 0x117BCC: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const (test_custom.cc:721)
==51661==    by 0x1252AF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:61)
==51661==    by 0x1230B2: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}&, int&&) (invoke.h:150)
==51661==    by 0x11FF0E: std::_Function_handler<void (int), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}>::_M_invoke(std::_Any_data const&, int&&) (std_function.h:290)
==51661==    by 0x12AB93: std::function<void (int)>::operator()(int) const (std_function.h:591)
==51661==    by 0x117B42: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}::operator()() const (test_custom.cc:722)
==51661==    by 0x1251FF: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:61)
==51661==    by 0x122F3D: std::enable_if<std::is_void<void>::value, void>::type std::__invoke_r<void, test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&>(test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}&) (invoke.h:150)
==51661==    by 0x11FE03: std::_Function_handler<void (), test_extreme_nested_scheduling()::{lambda()#1}::operator()() const::{lambda(int)#1}::operator()(int) const::{lambda()#1}>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51661==    by 0x10FE89: std::function<void ()>::operator()() const (std_function.h:591)
==51661== 
==51661== ----------------------------------------------------------------
==51661== 
==51661== Thread #2: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51661==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51661==    by 0x117D9E: test_extreme_nested_scheduling()::{lambda()#1}::operator()() const (test_custom.cc:733)
==51661==    by 0x127C96: void std::__invoke_impl<void, test_extreme_nested_scheduling()::{lambda()#1}>(std::__invoke_other, test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:61)
==51661==    by 0x12794C: std::__invoke_result<test_extreme_nested_scheduling()::{lambda()#1}>::type std::__invoke<test_extreme_nested_scheduling()::{lambda()#1}>(test_extreme_nested_scheduling()::{lambda()#1}&&) (invoke.h:96)
==51661==    by 0x12762B: void std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51661==    by 0x12746B: std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> >::operator()() (std_thread.h:299)
==51661==    by 0x1272F3: std::thread::_State_impl<std::thread::_Invoker<std::tuple<test_extreme_nested_scheduling()::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51661==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51661==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51661==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51661==    by 0x4C3EA33: clone (clone.S:100)
==51661== 
==51661== 
==51661== Use --history-level=approx or =none to gain increased speed, at
==51661== the cost of reduced accuracy of conflicting-access information
==51661== For lists of detected and suppressed errors, rerun with: -s
==51661== ERROR SUMMARY: 3820 errors from 13 contexts (suppressed: 57394 from 49)
[1;31m❌ FAILED[0m
[95m[T01][0m Parallel speedup benchmark (4 tasks)... ==51668== ---Thread-Announcement------------------------------------------
==51668== 
==51668== Thread #1 is the program's root thread
==51668== 
==51668== ---Thread-Announcement------------------------------------------
==51668== 
==51668== Thread #2 was created
==51668==    at 0x4C3EA23: clone (clone.S:76)
==51668==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51668==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51668==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51668==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51668==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x10EA94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (std_thread.h:164)
==51668==    by 0x10DDD7: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:19)
==51668==    by 0x117FDD: test_parallel_speedup() (test_custom.cc:749)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668==  Lock at 0x1FFEFFEA48 was first observed
==51668==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51668==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51668==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51668==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51668==    by 0x118027: test_parallel_speedup() (test_custom.cc:752)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51668==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51668==    by 0x11A0DF: main (test_custom.cc:951)
==51668==  Address 0x1ffeffea48 is on thread #1's stack
==51668==  in frame #3, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668==  Lock at 0x1FFEFFEAF0 was first observed
==51668==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51668==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51668==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51668==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51668==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51668==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51668==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51668==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51668==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51668==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51668==  Address 0x1ffeffeaf0 is on thread #1's stack
==51668==  in frame #3, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668== Possible data race during write of size 8 at 0x1FFEFFEAA0 by thread #1
==51668== Locks held: 1, at address 0x1FFEFFEA48
==51668==    at 0x1107A3: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::push_back(std::function<void ()> const&) (stl_deque.h:1545)
==51668==    by 0x10FC58: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::push(std::function<void ()> const&) (stl_queue.h:286)
==51668==    by 0x10DFEB: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:34)
==51668==    by 0x118027: test_parallel_speedup() (test_custom.cc:752)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51668==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51668==    by 0x11A0DF: main (test_custom.cc:951)
==51668== 
==51668== This conflicts with a previous read of size 8 by thread #2
==51668== Locks held: 1, at address 0x1FFEFFEAF0
==51668==    at 0x111440: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51668==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51668==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51668==    by 0x10E0C2: ThreadPool::dispatcher()::{lambda()#1}::operator()() const (thread-pool.cc:44)
==51668==    by 0x10EC40: void std::condition_variable::wait<ThreadPool::dispatcher()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::dispatcher()::{lambda()#1}) (condition_variable:104)
==51668==    by 0x10E13F: ThreadPool::dispatcher() (thread-pool.cc:43)
==51668==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51668==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51668==  Address 0x1ffeffeaa0 is on thread #1's stack
==51668==  in frame #3, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51668==    at 0x4851C1D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10E023: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:37)
==51668==    by 0x118027: test_parallel_speedup() (test_custom.cc:752)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51668==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51668==    by 0x11A0DF: main (test_custom.cc:951)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668==  Lock at 0x1FFEFFEA48 was first observed
==51668==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51668==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51668==    by 0x10F8E1: std::lock_guard<std::mutex>::lock_guard(std::mutex&) (std_mutex.h:249)
==51668==    by 0x10DFD4: ThreadPool::schedule(std::function<void ()> const&) (thread-pool.cc:33)
==51668==    by 0x118027: test_parallel_speedup() (test_custom.cc:752)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51668==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51668==    by 0x11A0DF: main (test_custom.cc:951)
==51668==  Address 0x1ffeffea48 is on thread #1's stack
==51668==  in frame #5, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668==  Lock at 0x1FFEFFEAF0 was first observed
==51668==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51668==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51668==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51668==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51668==    by 0x10E121: ThreadPool::dispatcher() (thread-pool.cc:42)
==51668==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51668==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51668==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51668==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51668==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51668==  Address 0x1ffeffeaf0 is on thread #1's stack
==51668==  in frame #5, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668==  Lock at 0x1FFEFFEB48 was first observed
==51668==    at 0x48512DC: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10F2C6: __gthread_mutex_lock(pthread_mutex_t*) (gthr-default.h:749)
==51668==    by 0x10F45F: std::mutex::lock() (std_mutex.h:113)
==51668==    by 0x110848: std::unique_lock<std::mutex>::lock() (unique_lock.h:141)
==51668==    by 0x10FC96: std::unique_lock<std::mutex>::unique_lock(std::mutex&) (unique_lock.h:71)
==51668==    by 0x10E7AF: ThreadPool::wait() (thread-pool.cc:116)
==51668==    by 0x118055: test_parallel_speedup() (test_custom.cc:756)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51668==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51668==  Address 0x1ffeffeb48 is on thread #1's stack
==51668==  in frame #5, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668== Possible data race during write of size 8 at 0x1FFEFFEA80 by thread #2
==51668== Locks held: 2, at addresses 0x1FFEFFEA48 0x1FFEFFEAF0
==51668==    at 0x110AAC: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::pop_front() (stl_deque.h:1582)
==51668==    by 0x10FDFF: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::pop() (stl_queue.h:321)
==51668==    by 0x10E1E9: ThreadPool::dispatcher() (thread-pool.cc:54)
==51668==    by 0x10DC10: ThreadPool::ThreadPool(unsigned long)::{lambda()#1}::operator()() const (thread-pool.cc:19)
==51668==    by 0x10F1BF: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:61)
==51668==    by 0x10F145: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#1}&&) (invoke.h:96)
==51668==    by 0x10F09F: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F047: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> >::operator()() (std_thread.h:299)
==51668==    by 0x10F00F: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#1}> > >::_M_run() (std_thread.h:244)
==51668==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51668== 
==51668== This conflicts with a previous read of size 8 by thread #1
==51668== Locks held: 1, at address 0x1FFEFFEB48
==51668==    at 0x111447: std::operator==(std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&, std::_Deque_iterator<std::function<void ()>, std::function<void ()>&, std::function<void ()>*> const&) (stl_deque.h:273)
==51668==    by 0x1108CE: std::deque<std::function<void ()>, std::allocator<std::function<void ()> > >::empty() const (stl_deque.h:1348)
==51668==    by 0x10FCE9: std::queue<std::function<void ()>, std::deque<std::function<void ()>, std::allocator<std::function<void ()> > > >::empty() const (stl_queue.h:219)
==51668==    by 0x10E72E: ThreadPool::wait()::{lambda()#1}::operator()() const (thread-pool.cc:118)
==51668==    by 0x10EC80: void std::condition_variable::wait<ThreadPool::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, ThreadPool::wait()::{lambda()#1}) (condition_variable:104)
==51668==    by 0x10E7CD: ThreadPool::wait() (thread-pool.cc:117)
==51668==    by 0x118055: test_parallel_speedup() (test_custom.cc:756)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==  Address 0x1ffeffea80 is on thread #1's stack
==51668==  in frame #5, created by test_parallel_speedup() (test_custom.cc:746)
==51668== 
==51668== ---Thread-Announcement------------------------------------------
==51668== 
==51668== Thread #3 was created
==51668==    at 0x4C3EA23: clone (clone.S:76)
==51668==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51668==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51668==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51668==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51668==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51668==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51668==    by 0x117FDD: test_parallel_speedup() (test_custom.cc:749)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668== Thread #3: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51668==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51668==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51668==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51668==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51668==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51668==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51668==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51668==    by 0x4C3EA33: clone (clone.S:100)
==51668== 
==51668== ---Thread-Announcement------------------------------------------
==51668== 
==51668== Thread #6 was created
==51668==    at 0x4C3EA23: clone (clone.S:76)
==51668==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51668==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51668==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51668==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51668==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51668==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51668==    by 0x117FDD: test_parallel_speedup() (test_custom.cc:749)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668== Thread #6: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51668==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51668==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51668==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51668==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51668==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51668==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51668==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51668==    by 0x4C3EA33: clone (clone.S:100)
==51668== 
==51668== ---Thread-Announcement------------------------------------------
==51668== 
==51668== Thread #5 was created
==51668==    at 0x4C3EA23: clone (clone.S:76)
==51668==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51668==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51668==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51668==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51668==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51668==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51668==    by 0x117FDD: test_parallel_speedup() (test_custom.cc:749)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668== Thread #5: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51668==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51668==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51668==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51668==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51668==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51668==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51668==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51668==    by 0x4C3EA33: clone (clone.S:100)
==51668== 
==51668== ---Thread-Announcement------------------------------------------
==51668== 
==51668== Thread #4 was created
==51668==    at 0x4C3EA23: clone (clone.S:76)
==51668==    by 0x4C3EBA2: __clone_internal_fallback (clone-internal.c:64)
==51668==    by 0x4C3EBA2: __clone_internal (clone-internal.c:109)
==51668==    by 0x4BB154F: create_thread (pthread_create.c:297)
==51668==    by 0x4BB21A4: pthread_create@@GLIBC_2.34 (pthread_create.c:836)
==51668==    by 0x4854975: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4955EB0: std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x10EB94: std::thread::thread<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}, , void>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (std_thread.h:164)
==51668==    by 0x10DE23: ThreadPool::ThreadPool(unsigned long) (thread-pool.cc:22)
==51668==    by 0x117FDD: test_parallel_speedup() (test_custom.cc:749)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668== Thread #4: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51668==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10E69C: ThreadPool::worker(int) (thread-pool.cc:110)
==51668==    by 0x10DC38: ThreadPool::ThreadPool(unsigned long)::{lambda()#2}::operator()() const (thread-pool.cc:22)
==51668==    by 0x10F182: void std::__invoke_impl<void, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(std::__invoke_other, ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:61)
==51668==    by 0x10F0F2: std::__invoke_result<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>::type std::__invoke<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}>(ThreadPool::ThreadPool(unsigned long)::{lambda()#2}&&) (invoke.h:96)
==51668==    by 0x10F073: void std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (std_thread.h:292)
==51668==    by 0x10F02B: std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> >::operator()() (std_thread.h:299)
==51668==    by 0x10EFEB: std::thread::_State_impl<std::thread::_Invoker<std::tuple<ThreadPool::ThreadPool(unsigned long)::{lambda()#2}> > >::_M_run() (std_thread.h:244)
==51668==    by 0x4955DB3: ??? (in /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.33)
==51668==    by 0x4854B7A: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x4BB1AA3: start_thread (pthread_create.c:447)
==51668==    by 0x4C3EA33: clone (clone.S:100)
==51668== 
==51668== ----------------------------------------------------------------
==51668== 
==51668== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==51668==    at 0x4851E0D: ??? (in /usr/libexec/valgrind/vgpreload_helgrind-amd64-linux.so)
==51668==    by 0x10E892: ThreadPool::~ThreadPool() (thread-pool.cc:128)
==51668==    by 0x1180CA: test_parallel_speedup() (test_custom.cc:761)
==51668==    by 0x12FD22: bool std::__invoke_impl<bool, bool (*&)()>(std::__invoke_other, bool (*&)()) (invoke.h:61)
==51668==    by 0x12E9C3: std::enable_if<!std::is_void<bool>::value, bool>::type std::__invoke_r<bool, bool (*&)()>(bool (*&)()) (invoke.h:138)
==51668==    by 0x12D073: std::_Function_handler<bool (), bool (*)()>::_M_invoke(std::_Any_data const&) (std_function.h:290)
==51668==    by 0x12AF37: std::function<bool ()>::operator()() const (std_function.h:591)
==51668==    by 0x118D0A: run_test(TestCase const&) (test_custom.cc:870)
==51668==    by 0x11A0DF: main (test_custom.cc:951)
==51668== 
==51668== 
==51668== Use --history-level=approx or =none to gain increased speed, at
==51668== the cost of reduced accuracy of conflicting-access information
==51668== For lists of detected and suppressed errors, rerun with: -s
==51668== ERROR SUMMARY: 14 errors from 8 contexts (suppressed: 316 from 23)
[1;31m❌ FAILED[0m

========================================
Ran 30 tests.
❌ SOME TESTS FAILED
========================================
==51159== 
==51159== Use --history-level=approx or =none to gain increased speed, at
==51159== the cost of reduced accuracy of conflicting-access information
==51159== For lists of detected and suppressed errors, rerun with: -s
==51159== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)
